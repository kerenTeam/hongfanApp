<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>充值中心</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/common.css"> 
		<link rel="stylesheet" type="text/css" href="../../css/index.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css"> 
		<link href="../../css/mui.indexedlist.css" rel="stylesheet" />
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<script src="../../js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/app.js" type="text/javascript" charset="utf-8"></script> 
		<style>
			html,
			body {
				font-size: 1rem;
				height: 100%;
				overflow: hidden;
			}
			.mui-bar {
				-webkit-box-shadow: none;
				box-shadow: none;
			}
		</style>
	 </head>
		<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">游戏充值</h1>
		</header>
		<script src="../../js/statusBar.js"></script><!--状态栏-->
		<div class="mui-content">
			<div id='list' class="mui-indexed-list">
				<div class="mui-indexed-list-search mui-input-row mui-search">
					<input type="search" class="mui-input-clear mui-indexed-list-search-input" placeholder="搜索游戏">
				</div>
				<div class="mui-indexed-list-bar">
					<a>A</a>
					<a>B</a>
					<a>C</a>
					<a>D</a>
					<a>E</a>
					<a>F</a>
					<a>G</a>
					<a>H</a>
					<a>I</a>
					<a>J</a>
					<a>K</a>
					<a>L</a>
					<a>M</a>
					<a>N</a>
					<a>O</a>
					<a>P</a>
					<a>Q</a>
					<a>R</a>
					<a>S</a>
					<a>T</a>
					<a>U</a>
					<a>V</a>
					<a>W</a>
					<a>X</a>
					<a>Y</a>
					<a>Z</a>
				</div>
				<div class="mui-indexed-list-alert"></div>
				<div class="mui-indexed-list-inner">
					<div class="mui-indexed-list-empty-alert">没有数据</div>
					<ul class="mui-table-view" id="gameList">
						<li data-group="A" class="mui-table-view-divider mui-indexed-list-group">A</li>
						<li data-value="啊" data-tags="aa" class="mui-table-view-cell mui-indexed-list-item">奥比岛</li>
						<li data-group="B" class="mui-table-view-divider mui-indexed-list-group">B</li>
						<li data-value="被" data-tags="bb" class="mui-table-view-cell mui-indexed-list-item">边锋</li>
						<li data-group="C" class="mui-table-view-divider mui-indexed-list-group">C</li>
						<li data-value="才" data-tags="cc" class="mui-table-view-cell mui-indexed-list-item">彩虹岛</li>
						<li data-group="D" class="mui-table-view-divider mui-indexed-list-group">D</li>
						<li data-value="都" data-tags="dd" class="mui-table-view-cell mui-indexed-list-item">大话西游2</li>
					</ul>
					<script type="text/javascript" id="gameListTpl">
						<%for(var i=0;i<gameList.length;i++){%>
							<li data-id="<%=gameList[i].gameId%>" data-mid="<%=gameList[i].manufacturerId%>" data-name="<%=gameList[i].gameName%>" data-mname="<%=gameList[i].manufacturerName%>" data-py="<%=gameList[i].pinyin%>" data-jpy="<%=gameList[i].simplePinyin%>" class="mui-table-view-cell mui-indexed-list-item"><%=gameList[i].gameName%></li>
							<%}%>
					</script>
				</div>
			</div>
		</div>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/mui.indexedlist.js"></script>
		<script src="../../js/artTemplate-native.js"></script>
		<script type="text/javascript" charset="utf-8">
			mui.init();
			mui.ready(function() {
				var header = document.querySelector('header.mui-bar');
				var list = document.getElementById('list');
				//calc hieght
				list.style.height = (document.body.offsetHeight - header.offsetHeight) + 'px';
				//create
				window.indexedList = new mui.IndexedList(list);
				
				mui.plusReady(function(){
					plus.nativeUI.showWaiting();
					var oldtoken = plus.storage.getItem('oldToken');
					mui.ajax(serverUrl+'/api/qianmi/gameslist',{
						dataType:'json',
						type:'post',
						timeout:'10000',
						headers:{"token":oldtoken},
						success:function(data,type,xhr){
							console.log(JSON.stringify(data));
							if(data.errno ==0 ){
								var gameobj = JSON.parse(data.data.body);
								var gameList = gameobj.game_list_response.games.game;
								if(gameList.length){
									document.getElementById("gameList").innerHTML = template("gameListTpl",{gameList:gameList});
									$("li.mui-indexed-list-item").click(function(){
										alert($(this).attr('data-id'))
										openview({
											view:"gameRecharge.html",
											id:"gameRecharge",
											extrasobj:{gameid:$(this).attr('data-id')}
										})
									})
								}
							}
							plus.nativeUI.closeWaiting();
						},
						error:function(xhr,type,errorThrown){
							plus.nativeUI.closeWaiting();
							console.log('响应失败  !');
						}
					})
				})
				
				 
				
			});
		</script>
	</body>

</html>