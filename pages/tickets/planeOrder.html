<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>机票订单</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/common.css">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<link rel="stylesheet" href="../../css/reset.css">
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<script type="text/javascript" src="../../js/mui.min.js"></script>
		<!--<script type="text/javascript" src="../../js/jquery.flexslider-min.js"></script>-->
		<!--<script src=" ../../js/hmt.js" type="text/javascript"></script>-->
		<!--<script src="../../js/other.js" type="text/javascript" charset="utf-8"></script>-->
		<script src="../../js/app.js" type="text/javascript" ></script>
		<!--引入模板引擎-->
		<script src="../../js/artTemplate-native.js" type="text/javascript" ></script>
		<style type="text/css">
			*{
				font-family: "微软雅黑";
			}
			.mui-bar{
				height: 50px;
				box-shadow: none;
			}
			.mui-title,.mui-icon{
				line-height: 50px;
			}
			.mui-bar .mui-icon{
				padding: 0;
			}
			#main{
				margin-top: 50px;
				/*padding-bottom: 60px !important;*/
			}
			
			.guess-like,dl.list{
				border-bottom: 1px solid #eee;
				background-color: #EFEFF4;
			}
			.right{
				text-align: right;
			}
			.middle{
				text-align: center;
			}
			.strong-color{
				color: #f53c42 !important;
			}
			.Lgray{
				font-size: 12px !important;
				color: #999 !important;
				margin-top: 14px;
			}
			.mui-badge-blue, .mui-badge-primary{
				background-color: #fff;
				border: 1px solid #999;
				color: #999 !important;
			}
			
			.moreone{
				line-height: 50px;
			}
			dl.list .db>.react{
				padding: 0;
				margin: 0;
			}
			dl.list .db{
				height: 50px;
			}
			.grade-eject>ul>li, .Category-eject>ul>li, .Sort-eject>ul>li{
				line-height: 40px;
			}
			
			/*这一页*/
			.timeBox{
				position: relative;
			}
			.timeBox p{
				font-size: 24px;
				color: #333;
				line-height: 22px;
			}
			.timeBox .ad{
				font-size: 12px;
				color: #999;
				font-weight: normal;
				line-height: 24px;
			}
			.timeBox .bage{
				position: absolute;
				font-size: 12px;
				line-height: 10px;
				right: 15px;
				top: 10px;
				color: #666;
			}
			.price{
				text-align: right;
				font-size: 24px;
				color: #f53c42;
			}
			.guess-like{
				padding-top:50px;
			}
			.react >div{
				line-height: 40px !important;
			}
			.airTip button{
				margin-left: 15px !important;
				background-color: #f53c42;
				color: #fff;
				border: none;
			}
			dl.list {
				border-top: none;
				margin-bottom: 10px; 
			}
			.react{
				padding: 0 .15rem !important;
			}
			dl.list dt, dl.list dd{
				background-color: #fff;
			}
			.lineL{
				border-left: 1px solid #DDD8CE;
			}
			.phone{
				border: none;
			}
			.title{
				font-size:16px;
				font-weight: bold;
			}
			.tiny{
				font-size: 12px;
				line-height: 14px;
				margin-top: -5px;
				margin-bottom: 10px;
			}
			.bo{
				color: #ffc900;
			}
			.addMan{
				background-color: #ffc900;
				border: none;
				color: #fff;
				margin-top: 10%;
				line-height: 24px;
				font-size: 15px;
				margin-left: 15%;
			}
			dl.list dt, dl.list dd{
				border-bottom: 1px solid #EFEFF4;
			}
			.delete{
				width: 60%;
				margin-top: 20px;
			}
			/*header样式*/
			/*.mui-bar-nav {
				background-color: #FFF !important;
				border-bottom: 1px solid #EFEFF4;
			}
			.hasManyCitytwo .header-tit{
				color: #333;
			}
			.hasManyCitytwo .fanhui{
				color: #333;
			}*/
			.footerone .left{
				width: 60%;
			}
			.footerone p{
				text-align: left;
				font-size: 16px;
				text-indent: 15px;
				line-height: .5rem;
			}
			.red1{
				color: #f53c42;
			}
			.footerone .right{
				width: 40%;
			}
			.footerone .right .btn {
				 width: 100%; 
			}
			.gray{
				color: #999;
			}
			small{
				line-height: 12px !important;
				color: #666 !important;
			}
			input[type=text]{
				border: none;
				margin-bottom: 0;
				padding: 0;
				font-size: 14px;
			}
			.hLeft{
				text-align: right;
			}
			.hMiddle{
				text-align: center;
			}
			.hRight{
				text-align: left;
			}
			.head{
				background-color: #dcd5d5;
				margin-top: 50px !important;
				padding: 20px 0;
			}
			.toLine{
				width: 60%;
				height: 1px;
				margin: 10px 20%;
				background-color: #000;
			}
			dl.list{
				margin-top: 0;
			}
			.last{
				margin: 10px 15px;
				padding-bottom: 60px;
			}
			.last p{
				line-height: 20px;
			}
			.mui-bar-nav.mui-bar .mui-icon, .mui-title, #theSearch{margin: 0;}
		</style>
		<style type="text/css">
			.mui-bar {
				height: 50px;
				box-shadow: none;
			}
			
			.mui-title,
			.mui-icon {
				line-height: 50px;
			}
			
			.mui-bar .mui-icon {
				padding: 0;
			}
			
			#main {
				margin-top: 50px;
			}
			/*这一页*/
			
			.kv-line-r>h6,
			.kv-line-r>.kv-k {
				font-size: 13px;
			}
			
			.boxs {
				margin-bottom: 10px;
			}
			
			.boxs li {
				border-top: 0;
			}
			
			.boxstwo li a {
				width: 100%;
			}
			
			.mui-icon-location {
				width: 100%;
				text-align: center;
				margin-left: -7px;
			}
			
			.mui-col-sm-9 {
				padding-left: 15px;
			}
			
			.ico_arrow {
				position: absolute;
				top: 0;
				margin: 23px 0;
			}
			
			.phoneNum {
				float: right;
			}
			
			strong p {
				padding: 5px 10% 5px 0;
				line-height: 20px;
				color: #333;
			}
			
			.address {
				text-overflow: ellipsis;
				white-space: nowrap;
				overflow: hidden;
				width: ;
			}
			
			.middle-icon {
				padding: 4px 0;
			}
			
			.addBtn {
				background-color: #ff9100 !important;
				border: 1px solid #ff9100 !important;
			}
			
			.mui-numbox {
				width: 100px;
				height: 30px;
				padding: 0 30px;
			}
			
			.mui-numbox .mui-btn {
				width: 30px;
			}
			
			.addTitle {
				line-height: 30px;
			}
			
			.quanc {
				width: 0.3rem;
				margin-right: 0.1rem;
				display: none;
			}
			
			dl.list .dd-paddingtwo {
				padding: .08rem .15rem .08rem .15rem;
			}
			
			.addTitle img {
				width: 100%;
			}
			
			dl.list {
				border: 1px solid #eee;
			}
			
			dl.list dt,
			dl.list dd {
				border-bottom: 0px solid #eee;
				position: relative;
			}
			
			dl.list dt:after,
			dl.list dd:after {
				content: '';
				display: block;
				height: 1px;
				-webkit-transform: scaleY(0.3);
				background-color: rgba(0, 0, 0, 0.1);
				position: absolute;
				width: 100%;
				bottom: 0;
				left: 0;
			}
			
			dl.list dt:last-child:after,
			dl.list dd:last-child:after {
				height: 0;
			}
			
			.price {
				color: #ff5f32;
				line-height: 28px;
				font-size: 16px;
			}
			
			.kv-line-r>p span {
				color: #ff5f32;
			}
			
			.price sub {
				bottom: 0;
			}
			
			.num {
				float: right;
				color: #333;
			}
			
			p,
			h6 {
				color: #333;
			}
			
			.postWrap {
				background: #fff url(../../img/market/post.png) no-repeat bottom;
				background-size: 100%;
			}
			
			.boxstwo li a {
				margin: 10px 0;
			}
			
			#container {
				padding-bottom: 50px;
			}
			
			.goods p {
				padding: 3px 0;
				line-height: 20px;
			}
			
			.goodsDetail {
				font-size: 12px;
				color: #999;
				line-height: 15px !important;
			}
			
			.tips {
				margin-bottom: 0 !important;
				border: none !important;
				font-size: 14px;
				line-height: 16px;
			}
			
			.tipsWrap,
			.ztWrap {
				padding: 0 0.15rem !important;
			}
			
			.tipsWrap input,
			.ztWrap input {
				padding: 0 !important;
			}
			
			.tipsWrap h6,
			.ztWrap h6 {
				line-height: 40px;
				margin-right: 0;
			}
			
			.tipsWrap h6 .goods,
			.ztWrap h6 .goods {
				padding-left: 0;
			}
			
			dl.list dd dl {
				padding-left: 0;
			}
			
			dl.list dd dl>.dd-padding,
			dl.list dd dl dd>.react,
			dl.list dd dl>dt {
				padding: 0.15rem;
			}
			
			.goodsWrap {
				background-color: #fafafa;
			}
			
			.comm_btn {
				margin: 0;
				height: 50px;
				line-height: 50px;
				padding: 0;
				width: 100%;
				text-align: center;
			}
			
			.fixed .btn {
				border: none !important;
				bottom: 0;
				right: 0;
				width: 25%;
			}
			
			.fixed p {
				width: 75%;
				text-align: right;
			}
			
			.priceWrap {}
			
			.priceWrap p {
				text-align: right !important;
				display: block;
				font-size: 16px;
				width: 100%;
			}
			
			.priceWrap p sub {
				bottom: 0;
			}
			
			#coupon .mui-checkbox,
			.checkQuan .mui-checkbox,
			.waypay .mui-checkbox {
				position: absolute;
				top: 50%;
				margin-top: -18px;
				right: 0;
			}
			
			.mui-checkbox input[type=checkbox]:checked:before,
			.mui-radio input[type=radio]:checked:before {
				color: rgb(245, 60, 66);
			}
			
			.mui-card {
				margin: 0;
			}
			
			.checkQuan {
				padding: 2px 15px;
				border: 1px solid #f53c42;
				border-radius: 5px;
				line-height: 18px;
				margin: 5px 0;
				position: relative;
			}
			
			.checkQuan .mui-col-sm-3 {
				width: 28%;
				padding: 12px 5px;
				border-right: 1px dotted #f53c42;
			}
			
			.checkQuan .mui-col-sm-9 {
				width: 72%;
				padding: 12px 15px;
			}
			
			.cred {
				color: #f53c42;
			}
			
			.dateLimit {
				font-size: 12px;
			}
			
			#sfzin {
				width: -moz-calc(100% - 70px)!important;
				width: -webkit-calc(100% - 70px)!important;
				width: calc(100% - 70px)!important;
				font-size: 12px;
				padding: 0;
				text-align: right;
				background: none;
				console.log: none;
				height: auto;
				margin: 0;
				line-height: 12px;
				border: none;
			}
			
			.sf:after {
				height: 0px!important;
			}
			
			.mui-checkbox.mui-left label {
				padding-right: 15px;
				padding-left: 46px;
				padding-top: 14px;
			}
			
			.mui-radio input[type=radio]:before {
				font-size: 20px;
			}
			
			.mui-radio input[type=radio] {
				top: -20px;
			}
			
			#payChoose {
				top: 0;
				left: 0;
				bottom: 0;
				z-index: 9999;
				background-color: rgba(0, 0, 0, 0.2);
			}
			
			#payChoose p {
				text-align: center;
				color: black;
				position: relative;
				font-size: 0.16rem;
				padding: 15px;
			}
			
			#payChoose p:after {
				position: absolute;
				right: 0;
				bottom: 0;
				content: '';
				left: 0;
				height: 1px!important;
				-webkit-transform: scaleY(0.1);
				-webkit-transform-origin: bottom;
				background-color: #D1D2D4;
			}
			
			#payChoose p img {
				width: 16px;
				position: absolute;
				right: 15px;
				top: 50%;
				margin-top: -8px;
			}
			
			.paycontent {
				position: absolute;
				bottom: 0;
				left: 0;
				right: 0;
				background: #EEEEEE;
			}
			
			.mui-popover.mui-popover-action .mui-table-view {
				margin: 0;
			}
			
			.suborder a {
				background-color: #F53C42;
				color: white!important;
				border-radius: 5px!important;
				margin: 1px!important;
			}
			
			.paycontent img {
				width: 30px;
				margin-right: 15px;
			}
			
			.waypay li {
				background: white;
				color: black;
				font-size: 0.15rem;
				text-align: left;
			}
			
			.waypay li img.fr {
				width: 25px;
				vertical-align: middle;
			}
			
			.paytip {
				position: relative;
				background: white;
				padding: 15px;
				text-align: center;
				font-size: 0.14rem;
			}
			
			#totalPayCash {
				color: red;
			}
			
			.charge {
				color: coral;
			}
			
			.choosewl {
				position: relative;
				width: 100vw;
				left: 50%;
				right: 50%;
				margin-left: -50vw;
				margin-right: -50vw;
				padding: inherit!important;
			}
			
			.choosewl.mui-active a {
				background: #EEEEEE;
			}
			
			.dlc div {
				width: 100%;
				font-size: 0.12rem;
				line-height: 2;
				position: relative;
			}
			
			.dlc div:not(:last-of-type):after {
				position: absolute;
				right: 0;
				bottom: 0;
				content: '';
				left: 0;
				height: 1px!important;
				-webkit-transform: scaleY(0.3);
				-webkit-transform-origin: bottom;
				background-color: #D1D2D4;
			}
			
			.wlway {
				padding-right: 15px;
			}
			.mui-bar-nav.mui-bar .mui-icon, .mui-title, #theSearch{margin: 0;}
		</style>
	</head>
	<body>
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize"></a>
		    <h1 class="mui-title">机票订单</h1>  
		</header>
		<script src="../../js/statusBar.js"></script><!--状态栏-->
		<div id="main">
			<div class="head">
				<div class="mui-row">
				    <div class="mui-col-sm-4 mui-col-xs-4 hLeft">
						<div class="timeBox">
							<p class="ad black"><span id="orgCityName"></p>
							<p><span id="depTime"></p>
							<p class="ad black"><span id="orgCityName2"></p>
						</div>
			       	</div>
			        <div class="mui-col-sm-4 mui-col-xs-4 hMiddle">
			        	<div class="timeBox">
							<p class="ad black"><span id="flightNo" style="font-size: 10px;"></p>
							<div class="toLine"></div>
							<p class="ad black"><span id="flightCompanyName" style="margin-top: 10px;font-size: 10px;"></span></p>
						</div>
			        </div>
			         <div class="mui-col-sm-4 mui-col-xs-4 hRight">
						<div class="timeBox">
							<p class="ad black"><span id="dstCityName"></p>
							<p><span id="arriTime"></p>
							<p class="ad black"><span id="dstCityName2"></p>
						</div>
			       	</div>
				</div>
			</div>
			<dl class="list" id="goodsList">
				<dd class="goodsItem" id="order1">
					<a class="react mui-row">
						<div class="mui-col-sm-12 mui-col-xs-12">
							<p class="black title"><span id="fromTime"></span>&nbsp;<span id="weekday"></span>&nbsp;<span id="depTime"></span>&nbsp;<span id="seatMsg"></span> </p>
				       </div>
					</a>
				</dd>
				<dd class="goodsItem" id="order2">
					<a class="react mui-row">
						<div class="mui-col-sm-6 mui-col-xs-6">
							<p class="black">成人票&nbsp;￥<span id="settlePrice"></span></p>
				       	</div>
				        <div class="mui-col-sm-6 mui-col-xs-6">
				        	<p class="black">基建燃油&nbsp;￥<span id="adultAirportTax"></span>+￥<span id="adultFuelTax"></span></p>
				        </div>
					</a>
				</dd>
			</dl>
			<dl class="list" id="goodsList">
				<dd class="goodsItem">
					<a class="react mui-row">
						<div class="mui-col-sm-8 mui-col-xs-8">
							<p class="black">添加/修改乘机人 </p>
							<p class="tiny">请确保姓名证件填写正确</p>
				       </div>
				        <div class="mui-col-sm-4 mui-col-xs-4">
				        	<button class="addMan" onclick="addPerson()">添加乘机人</button>
				        </div>
					</a>
				</dd>
					<!--<dd class="goodsItem persons">
						<a class="react mui-row aPerson">
							<div class="mui-col-sm-2 mui-col-xs-2">
								<img src="../../img/tickets/delete.png" class="delete" onclick="deletePerson(this)"/>
							</div><div class="mui-col-sm-10 mui-col-xs-10">
								<p class="black nameM">名字1</p>
								<p class="tiny black">身份证&nbsp;<span class="idM">身份证1</span></p>
								<p class="tiny black">手机号&nbsp;<span class="phoneM">手机号1</span></p>
							</div>
						</a>
					</dd>-->
				<dd class="goodsItem persons">
					<!--添加联系人位置-->
				</dd>
			</dl>
			<dl class="list" id="goodsList">
				<dd class="goodsItem">
					<a class="react mui-row">
						<div class="mui-col-sm-3 mui-col-xs-3">
							<p class="black">联系人 </p>
				       </div>
				        <div class="mui-col-sm-9 mui-col-xs-9">
				        	<input type="text" name="" id="contactPerson" value="游向前" class="phone" placeholder="联系人姓名"/>
				        </div>
					</a>
				</dd>
				<dd class="goodsItem">
					<a class="react mui-row">
						<div class="mui-col-sm-3 mui-col-xs-3">
							<p class="black">手机号码 </p>
				       	</div>
				        <div class="mui-col-sm-9 mui-col-xs-9">
				        	<input type="text" name="" id="contactPhone" value="17781694509" class="phone" placeholder="用于接收短信(必填)" style="font-family: '微软雅黑';"/>
				        </div>
					</a>
				</dd>
			</dl>
			<dl class="list LastList" id="goodsList">
				<dd class="goodsItem">
					<a class="react mui-row">
						<div class="mui-col-sm-3 mui-col-xs-3">
							<p>改签规则</p>
				       </div>
				        <div class="mui-col-sm-9 mui-col-xs-9">
				        	<p id="changeStipulate" style="line-height: 20px;font-size: 12px;margin: 10px 0;"></p>
				        </div>
					</a>
				</dd>
				<dd class="goodsItem">
					<a class="react mui-row">
						<div class="mui-col-sm-3 mui-col-xs-3">
							<p>退票规则</p>
				       	</div>
				        <div class="mui-col-sm-9 mui-col-xs-9">
				        	<p id="refundStipulate" style="line-height: 20px;font-size: 12px;margin: 10px 0;"></p>
				        </div>
					</a>
				</dd>
			</dl>
		</div>
		<dl class="list last">
			<p><span class="red1">*</span>购票须知</p>
			<p>1.机票相关业务处理时间为8:00-22:00。</p>
			<p>2.机票业务不做改签处理</p>
			<p>3.机票支持在线申请退废票和自愿退票，非自愿退票请根据平台规则联系客服处理。</p>
			<p>4.出票当日提交"退废票"，具体以航司规定为准。</p>
			<p>5.请仔细核对用户身份证号以及姓名，以免造成不必要的损失。</p>
			<p>6.行程单(报销凭证)机场提供打印服务。</p>
			<p>7.目前不支持飞机票保险货源。</p>
		</dl>
		<!--footerone star-->
		<div class="footerone clearfloat">
			<div class="left">
				<p class="red1"><sub>￥</sub><span id="subPrice"></span><sub class="gray">（共<span id="subPerson">1</span>人）</sub></p>
			</div>
			<div class="right ">
                <a onClick="goBuy()" class="btn btnone fl">立即购买</a>
			</div>
		</div>
		<!--操作表-->
		<div id="payChoose" class="mui-popover mui-popover-action mui-popover-bottom closePay">
			<div class="paycontent">
				<p><span>请选择支付方式</span><img src="../../img/close.svg" class="closePay"></p>
				<div class="paytip" style="display: none;">请尽快完成支付 金额<span id="totalPayCash">￥78.00</span></div>
				<ul class="mui-table-view waypay">
					<li class="mui-table-view-cell">
						<a href="#" id="alipay" data-pay="alipay"><img src="../../img/alipay2-2.png">支付宝</a>
					</li>
					<li class="mui-table-view-cell">
						<a href="#" id="wxpay" data-pay="wxpay"><img src="../../img/weixin2-2.png">微信 </a>
					</li>
				</ul>
				<!--<ul class="mui-table-view">
						<li class="mui-table-view-cell suborder">
							<a id="paycheck"><b>确定</b></a>
						</li>
					</ul>-->
			</div>
		</div>
		<!--footerone end-->
	</body>
	<script type="text/javascript">
		window.addPerson = function(){
			openview({ 
				view:'planeAddPerson.html'
			})
		}
	</script>
	<!--数据渲染-->
	<script type="text/javascript">
		//弹窗
		$(".paycontent").click(function() {
			event.stopImmediatePropagation()
		})
		$(".closePay").click(function() {
			event.stopPropagation();
			$("#payChoose").removeClass("mui-active");
		})
		//调系统支付前置方法
		var pays = {};
		function plusReady() {
			plus.payment.getChannels(function(channels) {
				var content = document.getElementById('dcontent');
				var txt = '支付通道信息：';
				for(var i in channels) {
					var channel = channels[i];
					if(channel.id == 'qhpay' || channel.id == 'qihoo') { // 过滤掉不支持的支付通道：暂不支持360相关支付
						continue;
					}
					pays[channel.id] = channel;
					txt += 'id:' + channel.id + ', ';
					txt += 'description:' + channel.description + ', ';
					txt += 'serviceReady:' + channel.serviceReady + '； ';
					checkServices(channel);
				}
			}, function(e) {
				mui.alert('获取支付通道失败：' + e.message);
			});
		}
		document.addEventListener('plusready', plusReady, false);
		function checkServices(pc) {
			if(!pc.serviceReady) {
				var txt = null;
				switch(pc.id) {
					case 'alipay':
						txt = '检测到系统未安装“支付宝快捷支付服务”，无法完成支付操作，是否立即安装？';
						break;
					default:
						txt = '系统未安装“' + pc.description + '”服务，无法完成支付，是否立即安装？';
						break;
				}
				plus.nativeUI.confirm(txt, function(e) {
					if(e.index == 0) {
						pc.installService();
					}
				}, pc.description);
			}
		}
		//调系统支付前置方法结束
		
		
		var settlePrice,passagers;
		mui.plusReady(function(){
			var oldToken = plus.storage.getItem('oldToken');
			var userid = plus.storage.getItem('userid');
			var passagers = [];
			//从机票详情获取的数据
			var flightNo = plus.webview.currentWebview().flightNo;
			var fromPlace = plus.webview.currentWebview().fromPlace;
			var arrivePlace = plus.webview.currentWebview().arrivePlace;
			var fromTime = plus.webview.currentWebview().fromTime;
			var itemId = plus.webview.currentWebview().itemId;
			var seatCode = plus.webview.currentWebview().seatCode;//舱位编码
			var seatMsg = plus.webview.currentWebview().seatMsg;//舱位信息
			var flightCompanyCode = plus.webview.currentWebview().flightCompanyCode;//航空公司编码
			settlePrice = plus.webview.currentWebview().settlePrice;//价格
			var changeStipulate = plus.webview.currentWebview().changeStipulate;//改签规则
			var refundStipulate = plus.webview.currentWebview().refundStipulate;//退票规则
			var adultAirportTax = plus.webview.currentWebview().adultAirportTax;//基建费
			var adultFuelTax = plus.webview.currentWebview().adultFuelTax//燃油费
			var depTime = plus.webview.currentWebview().depTime//起飞时间
			var arriTime = plus.webview.currentWebview().arriTime//降落时间
			var orgCityName = plus.webview.currentWebview().orgCityName//起飞地点
			var dstCityName = plus.webview.currentWebview().dstCityName//降落地点
			var flightCompanyName = plus.webview.currentWebview().flightCompanyName//航空公司名字
			mui('#flightNo')[0].innerHTML = flightNo;				
			mui('#seatMsg')[0].innerHTML = seatMsg;				
			mui('#fromTime')[0].innerHTML = fromTime;	
			//修改星期日期时间
			var dateTime = fromTime.replace(/\-/g,'/');//将获取的日期如2017-01-01改为2017/01/01
			var date = new Date(dateTime).getDay();//获取具体周几
			var weekday=new Array(7);
				weekday[1]="周一";
				weekday[2]="周二";
				weekday[3]="周三";
				weekday[4]="周四";
				weekday[5]="周五";
				weekday[6]="周六";
				weekday[7]="周日";
			document.getElementById('weekday').innerHTML = weekday[date];
			//修改星期日期时间结束
			mui('#flightCompanyName')[0].innerHTML = flightCompanyName;//航空公司名字
			mui('#adultAirportTax')[0].innerHTML = adultAirportTax;//机场建设价
			mui('#adultFuelTax')[0].innerHTML = adultFuelTax;//燃油价
			mui('#depTime')[0].innerHTML = depTime;			
			mui('#arriTime')[0].innerHTML = arriTime;			
			mui('#orgCityName2')[0].innerHTML = orgCityName.replace("航站楼:","");	
			mui('#orgCityName')[0].innerHTML = orgCityName.split('(')[0];	
			mui('#dstCityName2')[0].innerHTML = dstCityName.replace("航站楼:","");	
			mui('#dstCityName')[0].innerHTML = dstCityName.split('(')[0];	
			mui('#adultFuelTax')[0].innerHTML = adultFuelTax;				
			mui('#adultAirportTax')[0].innerHTML = adultAirportTax;
			//总价计算
			var acountP = mui('.aPerson').length;
			if(acountP==0){
				$('#subPerson').html(0);
				mui('#subPrice')[0].innerHTML = 0.00;//总票价
				mui('#subPerson')[0].innerHTML = 0;//总人数
			}else{
				mui('#subPrice')[0].innerHTML = parseFloat(settlePrice) +adultAirportTax+adultFuelTax;//总票价
				
			}
			mui('#settlePrice')[0].innerHTML = settlePrice;//票价
			settlePrice = adultFuelTax+adultAirportTax+parseFloat(settlePrice);
			settlePrice = settlePrice.toFixed(2);
			mui('#changeStipulate')[0].innerHTML = changeStipulate;			
			mui('#refundStipulate')[0].innerHTML = refundStipulate;	
			
			//从添加乘机人获取的详情
			document.addEventListener('refreshPerson', function(obj) {
				var newName = obj.detail.newName;
				var idNo = obj.detail.idNo;
				var idPhone = obj.detail.idPhone;
				var persons = mui('.persons')[0];
				persons.insertAdjacentHTML('beforebegin', '<dd class="goodsItem persons"><a class="react mui-row aPerson"><div class="mui-col-sm-2 mui-col-xs-2"><img src="../../img/tickets/delete.png" class="delete" onclick="deletePerson(this)"/></div><div class="mui-col-sm-10 mui-col-xs-10"><p class="black nameM">'+newName+'</p><p class="tiny black idM">身份证&nbsp;'+idNo+'</p><p class="tiny black phoneM">联系电话&nbsp;'+idPhone+'</p></div></a></dd>'); 
				//组乘客信息

				if(!passagers || passagers==''){//如果为空
					passagers += newName +'!'+ idPhone +'!'+ idNo +'!';
				}else{
					passagers += '@@' + newName +'!'+ idPhone +'!'+ idNo +'!';
				}
				//重新计算人数和价格
				var acountP = $('.aPerson').length;
				$('#subPerson').html(acountP);
				var newPrice = settlePrice*acountP;//总价计算
				$('#subPrice').html(newPrice.toFixed(2));
				
				
			})
			
			//点击立即购买
			window.goBuy = function(){
//				plus.nativeUI.showWaiting('加载中 ...',{width:'100px',height:'80px'});//显示等待框
				
				var contactPerson = mui('#contactPerson')[0].value;
				var contactPhone = mui('#contactPhone')[0].value;
				var reg_phone = /^1((3|4|5|8|7){1}\d{1}|70)\d{8}$/;//手机号正则
				
				if(!passagers || passagers==''){
					mui.toast('请添加乘机人 !');
				}else if(contactPerson == ''){
					mui('#contactPerson')[0].focus(); 
					mui.toast('联系人人不能为空!');
				}else if(!reg_phone.test(contactPhone)){
					mui('#contactPhone')[0].focus(); 
					mui.toast('请输入正确的手机号码 !');
				}else{
					//提交生成订单
					$("#payChoose").addClass("mui-active"); //执行弹窗
					mui('#alipay')[0].onclick = function() {
						payfunfun('alipay');
					}
					mui('#wxpay')[0].onclick = function() {
						payfunfun('wxpay');
					}
					
					function payfunfun(payid){
						plus.nativeUI.showWaiting();
						var datastr1 = {
							userid:userid,
							seatCode:seatCode,
							passagers:passagers,
							itemId:itemId,
							contactName:contactPerson,
							flightNo:flightNo,
							date:fromTime,
							from:fromPlace,
							to:arrivePlace,
							companyCode:flightCompanyCode,
							contactTel:contactPhone,
							payType: payid
						};
						var sssss = {companyCode:"3U",
							contactName:"游向前",
							contactTel:"17781694509",
							date:"2017-06-30",
							flightNo:"3U8548",
							from:"PEK",
							itemId:"5500301",
							passagers:"游向前!17781694509!513701199405236539",
							payType:"alipay",
							seatCode:"H",
							to:"CTU",
							userid:"446"}
						
						console.log('支付数据所需',datastr1); 
						mui.ajax(serverUrl +'/api/qianmi/airordercreate',{
						data:datastr1,
							dataType:'json',
							type:'post',
							timeout:30000,
							headers:{"token":oldToken},
							success:function(data,type,xhr){ 
								console.log('预定',data);
								
								
								
								
								plus.nativeUI.closeWaiting();//关闭等待框
								mui.alert('第三方服务出错，请稍后再试！');
								
								if(data.data.body.air_order_create_response.ticketTrade || !data.data.body.air_order_create_response.ticketTrade ==''){
									var planeOrder = data.data.body.air_order_create_response.ticketTrade.tradeNo;
									Orderidfanhui1 = data.data.new_qianmi_order_id;
	//								openview({
	//									view:'planeRecordDetail.html',
	//									id:'planeRecordDetail',
	//									extrasobj:{tradeNo:planeOrder,Orderidfanhui:Orderidfanhui1}
	//								})
								}else{
									mui.toast("提交订单失败！");
								}
							},
							error:function(xhr,type,errorThrown){
								console.log('响应失败  !');
								plus.nativeUI.closeWaiting();//关闭等待框
								mui.alert('第三方服务出错，请稍后再试！');
								mui.toast("提交订单失败！");
							}
						});
					}
				}
				
			}
		})
		//点击删除，删除乘机人
		function deletePerson(thisP){
			mui.confirm('确认删除该乘机人？','',['取消','确认'],function (e) {
				if(e.index == 1) { 
					$(thisP).parents('.aPerson').remove();
					//重新计算人数和价格
					var acountP = $('.aPerson').length;
					if(acountP==0){
						$('#subPerson').html(0);
						$('#subPrice').html(0.00);
					}else{
						$('#subPerson').html(acountP);
						var newPrice = settlePrice*acountP;//总价计算
						$('#subPrice').html(newPrice.toFixed(2));
					}
					
				}
			})
		}
		
		
	</script>

</html>