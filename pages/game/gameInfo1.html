<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>游戏娱乐</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/common.css">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css"/>
		<link rel="stylesheet" href="../../css/reset.css">
		<!--<link rel="stylesheet" type="text/css" href="../../css/localHost.css"/>--> 
		<script src="../../js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/app.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/artTemplate-native.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<style type="text/css">
		.activityIcon{
			width: 0.3rem;
			margin: 0 5px 0 15px;
			vertical-align: middle;
		}
		dl.list{
			border: none;
		}
		.acleft img{ 
			width: 0.7rem; 
			
		}
		.acright{  
			font-size: 0.18rem; 
    		left: 25%;
    		position: absolute;
    		top: 50%;
    		line-height: 0.2rem;
    		-webkit-transform: translateY(-50%);
    		transform:translateY(-50%) ;
		}
		.ddafter{ 
			padding:12px 15px 25px 15px;
			position: relative;  
		}
		.briefgame{ 
		 	line-height: 1.5;
		 	font-size: 0.13rem; 
		 	margin:3% 0;
		 	
		}
		.aclist{
			padding: 0 auto 0.05rem auto;
		}
	 	.gameName{ 
		    display: inline-block;
		    white-space: nowrap;
		    overflow: hidden;
		 }
		 .aclist{
		 	position: relative;
		 }
		 .mui-btn-outlined{ 
		 	border-color: coral;
		 	font-size: 0.14rem;
		 	color: coral!important;
		 	padding: 6px;
		 	margin: 5% 0; 
		 	border-radius: 180px;
		 } 
		 .npbk{
		 	    overflow-x: scroll; 
			  	 width: 100vw; 
			    white-space: nowrap;
			 	position: relative;
			 	left: 50%;
			 	right: 50%;
			 	margin-left: -50vw;
			 	margin-right: -50vw;
		 }
		 small{
		 	font-size: 0.12rem;
		 }
		 article img{
		 	margin: 0 2% 5% 0;
		    width: 50%;
		    display: inline-block; 
		    white-space: nowrap;
		 }
		 article img:first-child{
		 	margin-left: 15px;
		 }
		 article img:last-child{
		 	margin-right: 15px;
		 }
		 .anz{
		 	    position: fixed;
			    bottom: 10px;
			    width: 50%;
			    left: 50%;
			    margin-left: -25%;
		 }
		 .gameBi{
		 	font-size: 0.14rem;
		 	line-height: 0.2rem;
		 	margin-bottom: 0.2rem;
		 }
		 .gameBi label{
		 	color: gray;
		 	margin-right: 5px;
		 	display: inline;
		 }
		 big{
		 	font-size: 0.18rem;
		 	font-weight: 600;
		 }
		 #downGame{
		 	background-color: white!important;
		    /* width: 100%!important; */
		    position: fixed;
		    z-index: 99;
		    left: 0;
		    right: 0;
		    bottom: 0;
		    height: 0.5rem;
		 }
		 #gameOver{
		 	display: none;
		 	text-align: center;
		 	position:fixed ;
		 	color: black;
		 	bottom: 0.1rem;
		 	left: 0.35rem;
		 }
	</style>
	<body>
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize"></a>
		    <h1 class="mui-title">游戏娱乐</h1>
		</header>	
		<script src="../../js/statusBar.js"></script><!--状态栏-->
		<div id="container">		
			<div id="main"> 
				<div style="background-color: white;padding-bottom: 12px;" id="Alist">
					 <div class="ddafter">
						<div class="mui-row aclist"> 
								 <div class="fl acleft">
								 	<img src="http://image.game.uc.cn/2016/5/12/13149669.jpg" alt="" />
								 </div>
								 <div class="acright"> 
								 	<div class="gameName">王牌战舰</div>
								 	<br />
								 	<div class="gray"><small>游戏平台:安卓</small></div>
								 	<div class="gray"><small>上架时间:2016-08-22</small></div>
								 </div>  
						</div>
						<button type="button" class="mui-btn mui-btn-block mui-btn-outlined">游戏详情</button>
					<article> 
						<div class="npbk">
							<img src="http://image.game.uc.cn/2016/5/10/13131871.jpg" alt="" />
							<img src="http://image.game.uc.cn/2016/5/10/13131872.jpg" alt="" />
							<img src="http://image.game.uc.cn/2016/5/10/13131873.jpg" alt="" />
							<img src="http://image.game.uc.cn/2016/5/10/13131874.jpg" alt="" />
							<img src="http://image.game.uc.cn/2016/5/10/13131875.jpg" alt="" />
						</div>
						<ul class="gameBi">
							<li><label>大小</label> 32.9M</li>
							<li><label>版本</label> 3.3.0.1</li>
							<li><label>时间</label> 2016-08-22</li>
						</ul>
					</article>
					<article><big>游戏简介</big><br/><p class="briefgame">首创策略海战玩法，海上世界由你主宰。经典战舰悉数收录，打造你的王牌舰队。万人同屏军团争霸，闪击奇袭多样策略！超高自由度科技树，个性定制战舰搭配。各位指挥官们，一起约战吧</p></article>
					 </div> 
					</div>
			</div> 
		</div> 
		<div id="downGame">
			<div id="gameOver">
				<span class="mui-icon mui-icon-close"></span>
				<div style="font-size: 0.1rem;">取消</div>
			</div>
			<button id="download" onclick="createDownload(this)" type="button" class="mui-btn mui-btn-success anz">安装  32.9M</button> 
		   <small id="jindu"></small>
		</div>
	</body>
  
	<script type="text/javascript">
		//如果是ios则隐藏下载按钮
		if(/android/i.test(navigator.userAgent)) { //判断为android  
		} else if(/ipad|iphone/i.test(navigator.userAgent)) { //判断为ios  
			mui('#downGame')[0].remove();
		} else { //pc端访问  
			mui('#downGame')[0].remove();
		}
		mui.plusReady(function() {
			
			function GetNetWorkState() {
				var NetStateStr = '未知';
				var types = {};
				types[plus.networkinfo.CONNECTION_UNKNOW] = "未知";
				types[plus.networkinfo.CONNECTION_NONE] = "未连接网络";
				types[plus.networkinfo.CONNECTION_ETHERNET] = "有线网络";
				types[plus.networkinfo.CONNECTION_WIFI] = "WiFi网络";
				types[plus.networkinfo.CONNECTION_CELL2G] = "2G蜂窝网络";
				types[plus.networkinfo.CONNECTION_CELL3G] = "3G蜂窝网络";
				types[plus.networkinfo.CONNECTION_CELL4G] = "4G蜂窝网络";
				NetStateStr = types[plus.networkinfo.getCurrentType()];
		
				return NetStateStr;
			};
		 
			// 创建下载任务
			window.createDownload = function() {
				
				
				
				if(GetNetWorkState()=="未连接网络" || GetNetWorkState()=="未知"){
					plus.nativeUI.alert("未联网状态，不能下载");
					return;
				}else if(GetNetWorkState()=="有线网络" || GetNetWorkState()=="3G蜂窝网络" || GetNetWorkState()=="2G蜂窝网络" || GetNetWorkState()=="4G蜂窝网络"){
					 mui.confirm('非WiFi环境下确定下载？', '提示', ['取消', '确定'], function(e) {
						if(e.index == 1) { 
							startDownload()
						} 

					})
				}else{
					startDownload()
				}
				
				

				}
			//建立下载任务
//			http://ugame.9game.cn/game/downloadGame?pack.cooperateModelId=79346&pack.id=11846259
			function startDownload(){
					document.getElementById("jindu").style.display = "block"
					document.getElementById("download").innerHTML = "安装中";
					document.getElementById("gameOver").style.display = "inline-block";
					var dtask = plus.downloader.createDownload("https://p2.music.126.net/5G-StGyFIKjnno23wJO7EA==/7857110093212091.mp3", {}, function(d, status) {
						// 下载完成
						if(status == 200) { 
							
							d.filename = d.filename;
							
							document.getElementById("download").onclick = function() {
								plus.runtime.openFile(d.filename);
							}
						} else {
							plus.nativeUI.alert("下载失败");
						}
					});
					//dtask.addEventListener( "statechanged", onStateChanged, false );
					range("https://p2.music.126.net/5G-StGyFIKjnno23wJO7EA==/7857110093212091.mp3")
					dtask.start();
			}
			//取消下载任务
			document.getElementById("gameOver").onclick = function() {
				plus.downloader.clear(); 
				stop();
				document.getElementById("download").innerHTML = "安装 36.9M";
				          	document.getElementById("jindu").style.display="none";

				document.getElementById("gameOver").style.display = "none";
			}

			var req = new XMLHttpRequest();

			function range(url) {
           var percentComplete;
				// report progress events
				req.addEventListener("progress", function(event) {
					if(event.lengthComputable) {
						 percentComplete = parseFloat((event.loaded / event.total)*100).toFixed(0);
						document.getElementById("jindu").innerHTML = "(" + percentComplete + "%)";
							if(document.getElementById("jindu").innerHTML == "(100%)") { 
								document.getElementById("download").innerHTML = "打开"; 
							    document.getElementById("gameOver").style.display = "none";
								 
							} 
					}
				}, false); 
				req.open("GET", url);

				req.send(); 
                
			}

			function stop() {
				req.abort(); // 终止XMLHttpRequest对象 

				window.stop();
			}
		});
	</script>
	 

	
</html>
