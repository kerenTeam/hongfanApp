<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>专题</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/common.css"> 
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css" />
		<link rel="stylesheet" href="../../css/reset.css"> 
		<script type="text/javascript" src="../../js/jquery.min.js"></script>  
		<script src="../../js/mui.min.js"></script> 
		<script src="../../js/app.js"></script>
		<!--引入模板引擎-->
		<script src="../../js/artTemplate-native.js"></script>
		<style type="text/css">
			 img {
			 	width: 100%;
			 }
			  
		  
			figure {
			 
				margin: auto;
				position: relative;
			}
			.tc1 figure{
				padding-top: 50%;
			}
			.tc1 figure img{
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
			}
			.tc1 figure figcaption {
				position: absolute;
				font-size: 0.15rem;
				color: white;
				top: 50%;
				left: 50%;
				-webkit-transform: translate(-50%, -50%);
				z-index: 9;
				text-align: center;
				line-height: 1.2;
			}
			.tc2 figure{
				margin-bottom: 5px;
			}
			.tc2 figcaption{
				font-size: 0.15rem;
				display: block;
				background: white;
				padding: 15px 0;
				text-align: center
			}
			.tc2 figcaption small{
				font-size: 0.1rem;
				color: gray;
			}
			.fmask {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(0, 0, 0, 0.5);
			}
			.tab {
				
				font-size: 0px; 
			}
			
			.tab span {
				height: 50px;
				box-sizing: border-box;
				-webkit-box-sizing: border-box;
				font-size: 16px;
				display: inline-block;
				text-align: center;
				margin: 0 30px; 
			} 
			.tabActive { 
				
				color: white;
				border-bottom: 2px solid greenyellow;
			}
		
			.tabcontent {
				display: none;
			}
			.taactive{
				display: block;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" id="header">  
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize"></a>
		    <h1 class="mui-title">
		    	<div class="tab">
					<span class="tabActive">专题</span>
					<span>活动</span>
				</div>
		    </h1>
		     
		</header>
		<script src="../../js/statusBar.js"></script>
		<!--状态栏-->
		<!--<div id="container">-->
		<div id="main"> 
			<div id="none">
				<img src="../../img/unllfabu.svg" style="width: 1rem;display:none;margin: auto;margin-top: 30%;"/>
			</div>
			
			<div class="tabcontent tc1 taactive"> 
				<div id="themetic"></div>
				<script type="text/html" id="themeticTpl">
					<%for(var i=0;i<theameData.length;i++){%>
						<figure data-qid="<%=theameData[i].q_id%>" onclick="openfun('<%=theameData[i].q_id%>')">
							<div class="fmask"></div>
							<figcaption><%=theameData[i].title%></figcaption>
							<img src="<%=theameData[i].pic%>" style="width: 100%;" />
						</figure>
						<%}%>
				</script> 
			</div>
			<div class="tabcontent tc2">  
				<div id="activitise"></div>
				<script type="text/html" id="activitiseTpl">
					<%for(var i=0;i<theameData.length;i++){%>
						<figure data-qid="<%=theameData[i].q_id%>" onclick="openfun('<%=theameData[i].q_id%>')">  
							<img src="<%=theameData[i].pic%>" style="width: 100%;" />
							<figcaption><%=theameData[i].title%></figcaption> 
						</figure>
						<%}%>
				</script>
			</div>
			
			
		 
			</div>
			
	</body>
    <script type="text/javascript">
    	//跳转 详情
    	function openfun(id){
				openview({
					view: "themalist.html",
					extrasobj: {
						qid: id 
					}
				})
			}

    	mui.plusReady(function(){
    		var oldtoken = plus.storage.getItem('oldToken');
    		var type = plus.webview.currentWebview().type;
    		var acid = plus.webview.currentWebview().acid;
    		getThemetic(acid);
    		if(type == 2){
    			$(".tab span:first-child").removeClass("tabActive");
    			$(".tab span:last-child").addClass("tabActive");
    			$(".tabcontent:first-child").removeClass("taactive");
    			$(".tabcontent:last-child").addClass("taactive");
    		} 
	    	$(".tab span").click(function() {
				var i = $(this).index();
				$(".tab span").removeClass("tabActive")
				$(this).addClass("tabActive");
				if(!$(".tabcontent").eq(i).hasClass("taactive")) {
					getThemetic(i+1);
					$(".tabcontent").removeClass("taactive");
					$(".tabcontent").eq(i).addClass("taactive");
				}
			})
	    	

	    	//请求 专题/活动  数据
	    	function getThemetic(acid){
	    		plus.nativeUI.showWaiting();
	    		mui.ajax(serverUrl+"/api/news/activitylist",{
	    			data:{act_id:acid},
	        		dataType:'json',
	        		type:'post',
	        		timeout:10000,
					headers:{"token":oldtoken},	 
					success:function(data,type,xhr){ 
						console.log(JSON.stringify(data))
						if(data.errno == 0){
							if(data.data.length != 0){ 
	        					var theameObj = {};
	        					theameObj.myurl = serverimgUrl;
	        					theameObj.theameData = data.data;
	        					if(acid == 1){
	        						document.getElementById("themetic").innerHTML = template("themeticTpl",theameObj);
	        					}else{
	        						document.getElementById("activitise").innerHTML = template("activitiseTpl",theameObj);
	        					}
	        					
	        					plus.nativeUI.closeWaiting();
							}else{
								plus.nativeUI.closeWaiting();
								$('#none').css("display","block")
							}
						}
						
					},
					error:function(xhr,type,errorThrown){
						plus.nativeUI.closeWaiting()
						console.log('响应失败  !');
					}
	        	})
	    	}
	    	 
    	})
    	
    </script>
</html> 