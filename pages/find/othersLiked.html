<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>获赞</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no"> 
		<link rel="stylesheet" type="text/css" href="../../css/common.css">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css" />
		<link rel="stylesheet" href="../../css/reset.css">
		<link rel="stylesheet" href="../../css/one.css">
		<link rel="stylesheet" type="text/css" href="../../css/find.css" />
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/app.js"></script>
		<!--引入模板引擎-->
		<script src="../../js/artTemplate-native.js"></script>
		<style type="text/css">

		</style>
	</head>
	<style type="text/css">
            .userAvator{  
				width: 0.4rem;  
				height: 0.4rem;  
				border-radius: 50%;
				margin-right: 10px;
			}
			 .follow{
				position: relative;
				background-color: white;
				text-align: center;
				display: flex;
				align-items: center;
				padding:8px 15px;
				justify-content: space-between;
			} 
			 
			 .follow:after{
			 	position: absolute;
			 	content: '';
			 	height: 1px;
			 	left: 10px;
			 	right: 10px;
				-webkit-transform: scaleY(.5);
				background: #F0F0F0;
				bottom: 0;
			 }
			.follow button{
				font-size: 0.12rem;
				height: 0.28rem;
				width: 0.7rem; 
			}
			
			.fchidl>div{
				color: darkgray;
			}
			 
			
		 
	</style>

	<body>

		<header class="mui-bar mui-bar-nav">
		    <a class="headbar mui-action-back mui-icon mui-icon-left-nav mui-pull-left normalSize"></a>
		    <h1 class="mui-title" id="confirmbtn1">赞的</h1> 
		</header>
		<script src="../../js/statusBar.js"></script>
		<!--状态栏-->
		<!--<div id="container">-->
		<div id="main">
			<div id="likerList"></div>
			<script type="text/html" id="likerListTpl">
				<%for(var i=0;i<recommendData.liker.length;i++){%>
					<div class="follow" data-id="<%=recommendData.liker[i].user_id%>">
						<div class="fchidl">
							<%if(recommendData.liker[i].avatar){%>
				                <img src="<%=myUrl%><%=recommendData.liker[i].avatar[0].picImg%>" class="userAvator" alt="" /><%=recommendData.liker[i].nickname%>
	                        <%}else{%>
								 <img src="../../img/10.png" class="userAvator" alt="" /><%=recommendData.liker[i].nickname%>
							<%}%>
						</div> 
					</div>
				<%}%> 
			</script> 
		</div>
		
		 
	</body>
  <script type="text/javascript">
    
  	mui.plusReady(function(){
		var oldtoken = plus.storage.getItem('oldToken');
		var newsId = plus.webview.currentWebview().newsId;
			mui.ajax(serverUrl+"/api/news/newsinfo",{
    			data:{newsid:newsId},
        		dataType:'json',
				type:'post',
				timeout:10000,
				headers:{"token":oldtoken},	 
				success:function(data,type,xhr){
					if(data.errno == 0) { 
						if(data.data){ 
							var dataobj = data.data; 
							if(dataobj.liker){
								for(var i=0;i<dataobj.liker.length;i++){
									if(dataobj.liker[i].avatar){
										dataobj.liker[i].avatar = JSON.parse(dataobj.liker[i].avatar)
									}
									if(!dataobj.liker[i].nickname){
										dataobj.liker[i].nickname = "匿名"
									}else{
										 
										if(/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/.test(dataobj.liker[i].nickname)){
											dataobj.liker[i].nickname = dataobj.liker[i].nickname.substring(0,3)+"****"+dataobj.liker[i].nickname.substring(7,11)
										}
									} 
								}
							}   
							var recommendObj = {};
							recommendObj.myUrl = serverimgUrl;
							recommendObj.recommendData = dataobj; 
							document.getElementById("likerList").innerHTML = template("likerListTpl", recommendObj);
							$(".follow").on("click",function(){ 
							  	openview({
									view:'../othersPage.html',
									extrasobj:{userId:$(this).attr("data-id")}
								});
							})
						}
		 
					} 
					plus.nativeUI.closeWaiting(); //关闭等待框
				},
				error:function(xhr,type,errorThrown){
					plus.nativeUI.closeWaiting(); 
					console.log('响应失败  !');
				}
				 
        	})
	})		
  	
  </script>
</html>