<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>商品订单确认</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/common.css">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css">
		<link rel="stylesheet" href="../../css/reset.css">
		<!--<link href="../../css/mui.picker.min.css" rel="stylesheet" />
		<link href="../../css/mui.poppicker.css" rel="stylesheet" />-->
		<script src="../../js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<!--<script type="text/javascript" src="../../js/jquery.flexslider-min.js"></script>-->
		<!--<script type="text/javascript" src="../../js/swiper.min.js"></script>-->
		<!--<script src="../../js/mui.picker.min.js"></script>
		<script src="../../js/mui.poppicker.js"></script>
		<script src="../../js/other.js" type="text/javascript" charset="utf-8"></script>-->
		<style type="text/css">
			.mui-bar{
				height: 50px;
				box-shadow: none;
			}
			.mui-title,.mui-icon{
				line-height: 50px;
			}
			.mui-bar .mui-icon{
				padding: 0;
			}
			#main{
				margin-top: 50px;
			}
			
			/*这一页*/
			.kv-line-r>h6, .kv-line-r>.kv-k{
				font-size: 13px;
			}
			.boxs{
				margin-bottom: 10px;
			}
			.boxstwo li a{
				width: 100%;
			}
			.mui-icon-location{
				width: 100%;
				text-align: center;
				margin-left: -7px;
			}
			.mui-col-sm-9{
				padding-left: 15px;
			}
			.ico_arrow{
				position: absolute;
				top: 0;
				margin: 23px 0;
			}
			.phoneNum{
				float: right;
			}
			strong p{
				padding: 5px 10% 5px 0;
				line-height: 20px;
				color: #333;
			}
			.address{
				text-overflow: ellipsis;
				white-space: nowrap;
				overflow: hidden;
				width: ;
			}
			.middle-icon{
				padding: 4px 0;
			}
			.addBtn{
				background-color: #ff9100 !important;
				border: 1px solid #ff9100 !important;
			}
			.mui-numbox{
				width: 100px;
				height: 30px;
				padding: 0 30px;
			}
			.mui-numbox .mui-btn{
				width: 30px;
			}
			.addTitle{
				line-height: 30px;
			}
			dl.list .dd-paddingtwo {
				padding: .08rem .15rem .08rem .15rem;
			}
			.addTitle img{
				width: 100%;
			}
			dl.list{
				border: 1px solid #eee;
			}
			dl.list dt, dl.list dd{
				border-bottom: 1px solid #eee;
			}
			.price {
				color: #ff5f32;
				line-height: 28px;
				font-size: 16px;
			}
			.kv-line-r>p span{
				color: #ff5f32;
			}
			.price sub{
				bottom: 0;
			}
			.num{
				float: right;
				color: #333;
			}
			p,h6{
				color: #333;
			}
			.postWrap{
				background: #fff url(../../img/market/post.png) no-repeat bottom;
				background-size: 100%;
			}
			.boxstwo li a{
				margin: 10px 0;
			}
			#container{
				padding-bottom: 50px;
			}
			.goods p{
				padding: 3px 0;
				line-height: 20px;
			}
			.goodsDetail{
				font-size: 12px;
				color: #999;
				line-height: 15px !important;
			}
			.tips{
				margin-bottom: 0 !important;
				border: none !important;
				font-size: 14px;
				line-height: 16px;
			}
			.tipsWrap {
				padding: 0 0.15rem !important;
			}
			.tipsWrap input{
				padding: 0 !important;
			}
			.tipsWrap h6{
				line-height: 40px;
				margin-right: 0;
			}
			.tipsWrap h6 .goods{
				padding-left: 0;
			}
			dl.list dd dl{
				padding-left: 0;
			}
			dl.list dd dl>.dd-padding, dl.list dd dl dd>.react, dl.list dd dl>dt{
				padding: 0.15rem;
			}
			.goodsWrap{
				background-color: #fafafa;
			}
			.comm_btn{
				margin: 0;
				height: 50px;
				line-height: 50px;
				padding: 0;
				width: 100%;
				text-align: center;
			}
			.fixed .btn{
				border: none !important;
				bottom: 0;
				right: 0;
				width: 25%;
			}
			.fixed p{
				width: 75%;
				text-align: right;
			}
			.priceWrap{
			}
			.priceWrap p{
				text-align: right !important;
				display: block;
				font-size: 16px;
				width: 100%;
			}
			.priceWrap p sub{
				bottom: 0;
			}
		</style>
	</head>
	<body>
		<header class="mui-bar mui-bar-nav hasManyCity hasManyCitytwo">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize fl fanhui"></a>
		    <div class="header-tit">
				订单确认
			</div>
		</header>
		<div id="container">		
			<div id="main">
				<form class="wrapper-list">
					<ul class="boxs boxstwo postWrap">
						<li class="">
							<a href="#">
								<div class="mui-row orderRow">
								    <div class="mui-col-sm-1 mui-col-xs-1">
								    	<span class="mui-icon mui-icon-location middle-icon"></span>
								    </div>
								    <div class="mui-col-sm-11 mui-col-xs-11">
								    	<strong>									
											<p>收货人：瑾晨<span class="phoneNum">133434345</span></p>
											<p class="address">收货地址：安徽 合肥 蜀山区 合肥高新区管委会绝</p>
											<div class="fr"><i class="ico_arrow middle-icon"></i></div>
										</strong>
								    </div>
								</div>
							</a>
						</li>
					</ul>
					<div id="orderTpl"></div>
					<script type="text/html" id="orderData">
						<%for(var i =0;i<cates.length;i++){%>
						<dl class="list">
						<dd class="dd-padding kv-line-r">
							<h6><%=cates[i]%></h6>
						</dd>
						<%for(var j =0;j<goodsList.length;j++){%>
				<% if(goodsList[j].shopName ==  cates[i]){%>
						<dd class="dd-padding kv-line-r mui-row goodsWrap">
							<h6 class="addTitle mui-col-sm-4 mui-col-xs-4"><img src="../../img/19.jpg"/></h6>
							<div class="clearfloat fr mui-col-sm-8 mui-col-xs-8 goods">
			     				<p><%=goodsList[j].goodsName%></p>
			     				<p class="goodsDetail"><%=goodsList[j].goodText%></p>
			     				<p class="price"><sub>￥</sub><%=goodsList[j].goodsPrice%> <span class="num">×<%=goodsList[j].goodsnum%></span></p>
				     		</div>
						</dd>
						<%}%>
				<%}%>
						<dd class="dd-padding kv-line-r">
							<h6>配送方式</h6>
							<p class="jifen">快递 免邮</p>
						</dd>
						
						<dd class="dd-padding kv-line-r mui-row tipsWrap">
							<h6 class="addTitle mui-col-sm-1 mui-col-xs-2">备注：</h6>
							<div class="clearfloat fr mui-col-sm-11 mui-col-xs-10 goods">
			     				<input type="text" id="" value="" placeholder="选填（对本次交易的说明）" class="tips"/>
				     		</div>
						</dd>
						<dd class="kv-line-r dd-padding priceWrap">
							<p>
								<sub>共计1件商品&nbsp;&nbsp;小计：</sub>
								<span id="realPayMoney" class="J_total-price">2999.00</span>
							</p>
						</dd>
					</dl>
					<%}%> 
					</script>
					 
		
					<dl class="list">
						<dd>
							<a class="react" href="#">
								<div class="more moretwo more-weak comment-headline">
									抵用券
									<span class="more-after ">使用抵用券</span>
								</div>
							</a>
						</dd>
						<dd class="dd-padding kv-line-r">
							<h6>使用积分：</h6>
							<p class="jifen">本单不可用积分抵扣</p>
						</dd>
					</dl>
				</form>
			</div>
			<div class="fixed">
				<p>合计：<span class="show_delivery_fee">￥2999.00</span></p>
				<span class="fr btn">
					<a href="pay.html" class="comm_btn" id="submit_order">提交订单</a>
				</span>
			</div>
		</div>
	</body>
	<script src="../../js/app.js"></script>
	<script src="../../js/artTemplate-native.js"></script>
	<script type="text/javascript">
		mui.plusReady(function(){
			//订单缓存
		    var orderStorage =JSON.parse(plus.storage.getItem('$orderStorage')||'[]'); 
		    alert(orderStorage.length)
		    
		    
//		    orderObj.gid = $(this).attr("data-id");
//			orderObj.gdNum = $(this).attr("data-num");
//			orderObj.deltext = $(this).attr("data-goodstext");
//			orderObj.shopId = $(this).attr("data-shopId"); 
//			orderObj.shopName = $(this).attr("data-shop");
//			orderObj.gdname = $(this).attr("data-gdName");
//			orderObj.gdimg = $(this).attr("data-gdImg");
//			orderObj.gdPrice = $(this).attr("data-gdprice");
//			orderObj.postFee = $(this).attr("data-gdPostfee");
		    
		    
		    //订单数据模板
		    var data = {};
				data.goodsList = orderStorage;
				var arr = [];
				for(var i = 0; i < orderStorage.length; i++) {
					arr.push(orderStorage[i].shopName);
				}
				data.cates = arr.unique1();
				var html = template('orderTpl', data);
				document.getElementById('orderData').innerHTML = html;
		    
		})
		
		//数组去重
		Array.prototype.unique1 = function() {
			var res = [this[0]];
			for(var i = 1; i < this.length; i++) {
				var repeat = false;
				for(var j = 0; j < res.length; j++) {
					if(this[i] == res[j]) {
						repeat = true;
						break;
					}
				}
				if(!repeat) {
					res.push(this[i]);
				}
			}
			return res;
		}
	</script>
</html>
