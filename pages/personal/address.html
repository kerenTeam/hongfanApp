<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>管理收货地址</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/common.css">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css"/>
		<link rel="stylesheet" href="../../css/reset.css">
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<script type="text/javascript" src="../../js/jquery.flexslider-min.js"></script>
		<script src="../../js/hmt.js" type="text/javascript"></script>
		<script src="../../js/mui.min.js" type="text/javascript"></script>
		<script src="../../js/app.js" type="text/javascript"></script>
		<!--引入模板引擎-->
		<script src="../../js/artTemplate-native.js" type="text/javascript"></script>
		<style type="text/css">
			#main{
				margin-top: 50px;
			}
			.mui-bar-nav{
				box-shadow: none;
			}
			.mui-bar{
				height: 50px;
			}
			.mui-title,.mui-icon{
				line-height: 50px;
			}
			.mui-bar .mui-icon{
				padding: 0;
			}
			
			
			/*默认地址勾选*/
			
			
			
			/*消息提示框*/
			dialog{
				background-color: #fff !important;
			}
		</style>
	</head>
	<body>
		<header class="mui-bar mui-bar-nav hasManyCity hasManyCitytwo">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize fl fanhui"></a>
		    <div class="header-tit">
				管理收货地址
			</div>
		</header>
		<div id="addressList">
			
			
			<!--test-->
			<!--<div id="main" class="mui-clearfix contaniner">
		    	<div class="addlist clearfloat">
		    		<div class="top clearfloat box-s">
		    			<ul>
		    				<li>
		    					<span class="fl addId" name="<%= addressLi[i].id %>"></span>
		    					<span class="fr"></span>
		    				</li>
		    				<li>
		    					
		    				</li>
		    			</ul>
		    		</div>
		    		<div class="bottom clearfloat box-s">
		    			<section class="shopcar clearfloat">
		    				<div class="list listtwo clearfloat">
								<div class="xuan xuantwo clearfloat fl">
				    				<div class="radio" > 
									    <label>
									        <input type="checkbox" name="sex" value="" />
									        <div class="option"></div>
									    </label>
									</div>
				    		</div>
							<span class="mradd fl">默认地址</span>
							<div class="right fr clearfloat">
								<a href="javascript:;" class="fr exterminate">
									<i class="iconfont icon-lajixiang icon-shanchutwo"></i>
									删除
								</a>
								<a href="javascript:;" class="fr editAdd">
									<i class="iconfont icon-bianji bianjittt"></i>
									编辑
								</a>							
							</div>
							</div>
						</section>
		    		</div>
		    	</div>
		    </div>-->
			<!--test-->
			
			
			
		</div>
	    <!--模板铺数据-->
		<script id="addressList-detail" type="text/html">
			<div id="main" class="mui-clearfix contaniner">
			 	<% for(var i=0;i<addressLi.length;i++){ %>
			    	<div class="addlist clearfloat">
			    		<div class="top clearfloat box-s">
			    			<ul>
			    				<li>
			    					<span class="fl addId" name="<%= addressLi[i].id %>"><%= addressLi[i].person %></span>
			    					<span class="fr"><%= addressLi[i].phone %></span>
			    				</li>
			    				<li>
			    					<%= addressLi[i].city %><%= addressLi[i].area %><%= addressLi[i].address %>
			    				</li>
			    			</ul>
			    		</div>
			    		<div class="bottom clearfloat box-s">
			    			<section class="shopcar clearfloat">
			    				<div class="list listtwo clearfloat">
									<div class="xuan xuantwo clearfloat fl">
					    				<div class="radio" > 
										    <label>
										        <input type="checkbox" name="sex" value="" />
										        <div class="option"></div>
										    </label>
										</div>
					    		</div>
								<span class="mradd fl">默认地址</span>
								<div class="right fr clearfloat">
									<a href="javascript:;" class="fr exterminate">
										<i class="iconfont icon-lajixiang icon-shanchutwo"></i>
										删除
									</a>
									<a href="javascript:;" class="fr editAdd">
										<i class="iconfont icon-bianji bianjittt"></i>
										编辑
									</a>							
								</div>
								</div>
							</section>
			    		</div>
			    	</div>
		    	<% } %>
		    	<a href="add-address.html" class="address-add fl" id="addNewAd">
		     		添加新地址
		     	</a>
		    </div>
		</script>
		<!--模板引擎获取数据-->
		<script type="text/javascript" charset="utf-8">
	      	mui.init();
			mui.plusReady(function(){
//				//地址详情列表
//				mui.ajax('http://192.168.199.191:7200/api/useraddress/addresslist',{									
//					data:{"userid":4},
//					dataType:'json',//服务器返回json格式数据
//					type:'post',//HTTP请求类型
//					timeout:1000,//超时时间设置为10秒；
//					beforeSend:function(xhr){
//		                xhr.setRequestHeader("token","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9");//此处设置header参数键值对
//		            },
//					success:function(data){
//						var addressArray = data.hf_user_address;
//						var addressObj = {};
//						addressObj.addressLi = addressArray;
//						var html = template('addressList-detail',addressObj);
//						document.getElementById('addressList').innerHTML = html;
//						
//						//点击编辑跳转传参
//						var editAdd = document.getElementById('editAdd');
//						editAdd.addEventListener('tap', function(){
//							AddId = $(this).parents('.addlist').find('#addId').attr('name');
//							var url = "address-edit.html?index=A&name="+AddId;
//							openview({
//								view: url,
//							})
//						});
//				
//					},
//					error:function(xhr,type,errorThrown){
//						//异常处理；
//						console.log("获取失败！");
//						mui.toast("当前网络不好请重试");
//					}
//				});
					
				
				
				//地址详情列表
				mui.ajax('../../json/address.json',{									
//					data:{"userid":4},
					dataType:'json',//服务器返回json格式数据
					type:'get',//HTTP请求类型
					timeout:1000,//超时时间设置为10秒；
//					beforeSend:function(xhr){
//		                xhr.setRequestHeader("token","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9");//此处设置header参数键值对
//		            },
					success:function(data){
						var addressArray = data.hf_user_address;
						var addressObj = {};
						addressObj.addressLi = addressArray;
						var html = template('addressList-detail',addressObj);
						document.getElementById('addressList').innerHTML = html;
						//点击编辑跳转传参
						var editAdd = document.getElementsByClassName('editAdd');
						for (var j=0; j<editAdd.length; j++) {
							editAdd[j].addEventListener('tap',function(){
								var addId = $(this).parents('.addlist').find('.addId').attr('name');
								openview({
									view:'address-edit.html',
									extrasobj:{name:addId}
								})

							});
						}
						//删除确认弹框
						var exterminate = document.getElementsByClassName('exterminate');
						for (var m=0; m<exterminate.length; m++) {
							exterminate[m].addEventListener('tap',function(){
								mui.confirm('确认删除该地址？','',['取消','确认'],function (e) {
									e.index       
								},'div')
							});
						}
						//点击添加地址跳转
						var addNewAd = document.getElementById('addNewAd');
						addNewAd.addEventListener('tap',function(){
							var url = "add-address.html";
							window.open(url);
						});
					},
					error:function(xhr,type,errorThrown){
						//异常处理；
						console.log("获取失败！");
						mui.toast("当前网络不好请重试");
					}
				});
			})
	    </script>
	</body>	
</html>
