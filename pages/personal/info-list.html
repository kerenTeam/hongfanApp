<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>我的通知消息</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/common.css">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css"/>
		<link rel="stylesheet" href="../../css/reset.css">
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<script type="text/javascript" src="../../js/jquery.flexslider-min.js"></script>
		<script src="../../js/hmt.js" type="text/javascript"></script>
		<script src="../../js/mui.min.js" type="text/javascript"></script>
		<style type="text/css">
			dl.list dt, dl.list dd, dl.list{
				margin-bottom: 4%;
				background-color: #fff;
			}
			dl.listtwo dd{
				padding: 0;
				margin: 10px;
				box-shadow: 0px 0px 6px #ccc;
			}
			.list{
				background-color: #efeff4 !important;
			}
			dl.listtwo dd>.react {
				padding: .1rem .12rem .2rem .15rem;
			}
			.imgbox{
				width: 100%;
				margin-top: 7px;
			}
			.name{
				line-height: 22px;
				padding-left: 10px;
				color: #666;
				overflow: hidden;
				text-overflow: ellipsis;
				display: -webkit-box;
				-webkit-line-clamp: 3;
				-webkit-box-orient: vertical;
			}
			a.react{
				display: table;
			}
			.infoTitle{
				line-height: 40px;
				font-size: 16px;
			}
			dl.list{
				border: none;
			}
			.nothing img{
				display: block;
				margin: 20px auto;
				width: 80px;
			}
			.nothing p{
				text-align: center;
			}
			.notice .tab-bd{
				padding-top: 0;
			}
			#main{
				padding-top: 2px !important;
			}
			.dealcard{margin: 0;}
		</style>
	</head>
	<body>
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize"></a>
		    <h1 class="mui-title">我的通知消息</h1>  
		</header>
		<script src="../../js/statusBar.js"></script><!--状态栏-->
		<div id="main">
			<dl class="list listtwo list-in" id="listinfodiv"></dl>
			<script id="listinfo" type="text/html">
				<%if(list.length){%>
					<% for(var i=0;i<list.length;i++){ %>
						<dd>
							<a class="react">
								<div class="dealcard dealcardtwo clearfloat">
									<div class="mui-row">
										<div class="mui-col-sm-12 mui-col-xs-12 infoTitle"><%= list[i].title%></div>
									    <div class="mui-col-sm-2 mui-col-xs-2">
									    	<img src="../../img/12.png" class="imgbox">
									    </div>
									    <div class="mui-col-sm-10 mui-col-xs-10 name">
									    	<%= list[i].content%>
									    </div>
									    <div style="text-align: right;font-size: 13px;color: #888;"><%= list[i].create_time.split('T')[0]%></div>
									</div>
								</div>
							</a>
						</dd>
					<%}%>
				<%}%>	
					
			</script>	
				
			<div class="nothing" style="display: none;"><img src="../../img/theList/del.png"/><p>你没有通知消息哟！</p></div>
		</div>
	</body>
	<script src="../../js/app.js"></script>
	<script src="../../js/artTemplate-native.js"></script>
	<script type="text/javascript">
		mui.plusReady(function(){
			var myuserid = plus.storage.getItem('userid');
			var oldtoken = plus.storage.getItem('oldToken'); 
			plus.nativeUI.showWaiting('加载中 ...',{width:'100px',height:'80px'});//显示等待框
			mui.ajax(serverUrl+'/api/index/message',{
					data:{userid:myuserid},
					dataType:'json',
					type:'post',
					timeout:10000,
					headers:{"token":oldtoken},
					success:function(data,type,xhr){
						console.log('消息',data);
				       	if(data.errno == 0){
			     			var dataobj = {};
			     			dataobj.url = serverimgUrl;
			     			dataobj.list = data.data;
			     			var html = template("listinfo",dataobj);
							document.getElementById("listinfodiv").innerHTML+=html;
				       	}
				       	plus.nativeUI.closeWaiting();
					},
					error:function(xhr,type,errorThrown){
						plus.nativeUI.closeWaiting();
						console.log('当前网络不好,请重试');
					}
				});
		})
		function helpRecord(){
			openview({
				view:'my-answer.html'
			})
		}
	</script>
</html>
