<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>优惠</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/common.css">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css"/>
		<link rel="stylesheet" href="../../css/reset.css">
		<link rel="stylesheet" type="text/css" href="../../css/localHost.css"/> 
		<script src="../../js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/app.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/artTemplate-native.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<style type="text/css">
		header{
			box-shadow: none!important;
		}
		.activityIcon{
			width: 0.3rem;
			margin: 0 5px 0 15px;
			vertical-align: middle;
		}
		dl.list{
			border: none;
		}
		.acleft img{ 
			width: 1rem;
			height: 1rem;
			
		}
		.acright{ 
			width:-moz-calc(100% - 1rem);
			width:-webkit-calc(100% - 1rem);
			width: calc(100% - 1rem);
			font-size: 0.14rem;
			line-height: 0.245rem;
    		padding-left: 5%;
		}
		.ddafter{ 
			padding:12px 12px;
			position: relative;
		}
		.ddafter:not(:last-child):after{
			content: '';
			position: absolute;
			width: 100%;
			display: block;
			bottom: 0;
			height: 1px;
			left: 0;
			background-color: rgba(0,0,0,0.1);
			-webkit-transform: scaleY(0.5);
		}
		.aclist{
			padding: 0 auto 0.05rem auto;
		}
	 
	</style>
	<body>
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize"></a>
		    <h1 class="mui-title">优惠</h1>
		</header>	
		<script src="../../js/statusBar.js"></script><!--状态栏-->
		<div id="container">		
			<div id="main">
				<!--<div class="mui-row" style="padding: 0.1rem 0;border-left: 3px solid #f1a6ac;">
						<p class="black"><img src="../../img/localLife/facti.png" class="activityIcon" alt="" /> 同城交友</p>
					</div>-->
				<div style="background-color: white;" id="Alist"></div>
					
					<!-- <div class="mui-table-view-cell ddafter">
						<div class="mui-row aclist">
							 <div class="fl acleft">
							 	<img src="../../img/localLife/acf.png" alt="" />
							 </div>
							 <div class="fl acright">
							 	<p class="gray">户外</p>
							 	<div class=""><b>野餐活动</b></div>
							 	<div><small>时间：2016.12.12 - 2017.01.12</small></div>
							 	<div><small>地点： 邻水 xxx街道</small></div>
							 	<div><small>费用： 免费</small></div>
							 </div>
						</div>
					</div> 
					
					<div class="mui-table-view-cell ddafter">
						<div class="mui-row aclist">
							 <div class="fl acleft">
							 	<img src="../../img/localLife/Img267346995.jpg" alt="" />
							 </div>
							 <div class="fl acright">
							 	<p class="gray">室内</p>
							 	<div class=""><b>歌唱联欢</b></div>
							 	<div><small>时间：2016.12.12 - 2017.01.12</small></div>
							 	<div><small>地点： 邻水 xxx街道</small></div>
							 	<div><small>费用： ￥100</small></div>
							 </div>
						</div>
					</div> -->
					
				</div>
				
				<!--渲染数据-->
				<script type="text/html" id="Alist-detail">
					<% for(var i = 0;i<objData.length;i++){ %>
						<div class="mui-table-view-cell ddafter" onclick="activity(<%= objData[i].id %>)">
							<div class="mui-row aclist">
								 <div class="fl acleft">
								 	<img src="<%= objData[i].wrapImg %>" alt="" />
								 </div>
								 <div class="fl acright">
								 	<p class="gray"><%= objData[i].title %></p>
								 	<div class=""><%= objData[i].title %></div>
								 	<div><small>时间：<%= objData[i].begin_time %>到<%= objData[i].end_time %></small></div>
								 	<div><small>地点： <%= objData[i].site %></small></div>
								 </div>
							</div>
						</div>
					<% } %>
				</script>
			</div>
		</div>
	</body>
	<script type="text/javascript">
		function activity(id){
			openview({
				view:'couponDetail.html',
//				extrasobj:{activityId:id}
			})
		}
		mui.plusReady(function(){
			//打开义工页面
//			mui("#main").on('tap','.ddafter',function(){
//				mui.openWindow({
//				    url:'apprenticeDetail.html',
//				    id:'apprenticeDetail',
//				    styles:{
//				      top:0,//新页面顶部位置
//				      bottom:0,//新页面底部位置
//				    },
//				    extras:{
//				      
//				    },
//				    createNew:false,//是否重复创建同样id的webview，默认为false:不重复创建，直接显示
//				    show:{
//				      autoShow:true,//页面loaded事件发生后自动显示，默认为true
//				    },
//				    waiting:{
//				      autoShow:true,//自动显示等待框，默认为true
//				      title:'正在加载...',//等待对话框上显示的提示内容
//				      options:{
//				      }
//				    }
//				});
//				
//			});
//			
		
			//铺数据
			plus.nativeUI.showWaiting("加载中...",{width:'100px',height:'80px'});
			var oldToken = plus.storage.getItem('oldToken');
			console.log(oldToken);
			mui.ajax(serverUrl+'/api/index/coupon',{
//				data:{id:1},
				dataType:'json',
				type:'post',
				timeout:10000,
				headers:{"token":oldToken},	 
				success:function(data,type,xhr){
					alert(JSON.stringify(data.data));
					var dateObj={};
					for(var i = 0;i < data.data.length;i++){
						data.data[i].create_time = data.data[i].create_time.split('T')[i]; 
			       		data.data[i].begin_date = data.data[i].begin_date.split('T')[i]; 
			       		data.data[i].end_date = data.data[i].end_date.split('T')[i]; 
					}
					dateObj.objData=data.data;
					mui('#Alist')[0].innerHTML = template('Alist-detail',dateObj);
					plus.nativeUI.closeWaiting();
				},
				error:function(xhr,type,errorThrown){
					alert('响应失败  !');
				}
			});
			
			
		});
	</script>
</html>
