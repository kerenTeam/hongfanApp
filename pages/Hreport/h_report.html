<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>家乡报道</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/mui.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/localHost.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/one.css"/>
		<script src="../../js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/artTemplate-native.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<!--<script type="text/javascript" src="../../js/iscroll.js"></script>

		<script src="../../js/swiper.min.js" type="text/javascript" ></script>
		<script type="text/javascript" src="../../js/index.js"></script>-->
		<style type="text/css">
			/*banner底部导航*/
			.mui-slider-indicator .mui-indicator{
				width: 10px;
				height: 10px;
				border-radius: 8px;
				background: black;
				margin-right: 5px;
				opacity: 0.3;
				cursor: pointer;
				border: none;
				box-shadow: none;
			}
			.mui-slider-indicator .mui-active.mui-indicator{
				background-color: rgba(245,60,66,0.8);
				box-shadow: none;
				opacity: 1;
				border: none;
			}
			
			.mui-slider{
				margin-top: 50px;
			}
			.mui-bar-nav{
				box-shadow: none;
			}
			
			.infolist div p{
				margin-top: 15px;
				line-height: 22px;
				margin-bottom: 10px;
			}
			.editbtn{
				background-color: #fff;
				left: 50%;
				margin-left: -7.5%;
				box-shadow: 0 0 10px #555;
				text-align: center;
				padding:5px 0;
			}
			.editbtn img{
				width:50px !important;
				height:50px !important;
				
			}
			.infolist{
				padding-bottom: 80px;
			}
			.mui-media-body{
				white-space: normal;
				color:#333;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize"></a>
		    <h1 class="mui-title">家乡报道</h1>
			<a class="fr shoucang mui-icon mui-icon-bars mui-pull-right" id="theSearch" href="javascript:;"></a>
		</header>
		<!--轮播图-->
		<div class="mui-slider" id="focusNews">
			  
		</div>
		<!--轮播图结束-->
		<!--图文列表-->
		<div class="infolist">
			<ul class="mui-table-view" id="news">
				
			</ul>
		</div>
		<div class="editbtn">
			<img src="../../img/bianjibtn.svg"/>
		</div>
		<script src="../../js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			var infolist = mui('.infolist div');
			
			for(var i=0; i<infolist.length; i++ ){
				infolist[i].addEventListener('tap',function(){
					openview({
						view:'listinfo.html'
					});
				})
			}
			//发帖
			mui('.editbtn')[0].addEventListener('tap',function(){
				openview({
					view:'addpost.html'
				});
			});
			mui.plusReady(function(){
				var loginInfo=JSON.parse(plus.storage.getItem("$loginInfo"));	
				
				mui.ajax('../user.json',{									
						data:{"phone":loginInfo.account},
						dataType:'json',//服务器返回json格式数据
						type:'post',//HTTP请求类型
						timeout:10000,//超时时间设置为10秒；	              
						success:function(data){
							//console.info(userInfo,data);
							//获取并渲染焦点新闻信息
							var html=template("focusNewsModal",data);
							document.getElementById("focusNews").innerHTML=html;
							//获取并渲染焦点热门信息
							var html=template("newsModal",data);
							document.getElementById("focusNews").innerHTML=html;
						},
						error:function(xhr,type,errorThrown){
							//异常处理；
							console.log("获取失败！");
							mui.toast("当前网络不好请重试");
						}
				});
				
				
			});
			
			
			
		</script>
		<script type="text/html" id="newsModal">
			<% for(var i=0;i<news.length;i++){%>
			<li class="mui-table-view-cell mui-media">
				<a href="javascript:;">
					<img class="mui-media-object mui-pull-right" src="<%=news[i].newsimg%>">
					<div class="mui-media-body">
						<%= news[i].newsTitle %>
						<p class='mui-ellipsis'><%= news[i].createTime %></p>
					</div>
				</a>
			</li>
			<%}%>
		</script>
		<script type="text/html" id="focusNewsModal">
			
			<div class="mui-slider-group mui-slider-loop">
			    <!--支持循环，需要重复图片节点-->
			    
			    <div class="mui-slider-item mui-slider-item-duplicate"><a href="#"><img src="<%= focusNews[0].focusNewsimg %>" /></a></div>
			    <% for(var i=0;i<focusNews.length;i++){%>
			    <div class="mui-slider-item"><a href="#"><img src="<%= focusNews[i].focusNewsimg %>" /></a></div>
			  	<%}%>
			    <!--支持循环，需要重复图片节点-->
			    <div class="mui-slider-item mui-slider-item-duplicate"><a href="#"><img src="<%= focusNews[0].focusNewsimg %>" /></a></div>
			</div>
			 <div class="mui-slider-indicator">
                <div class="mui-indicator"></div>
                <div class="mui-indicator"></div>
                <div class="mui-indicator"></div>
             </div> 			
		</script>
	</body>
	
</html>