<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>个人主页</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no"> 
		<!--<link rel="stylesheet" type="text/css" href="../css/common.css">-->
		<link rel="stylesheet" type="text/css" href="../css/index.css">
		<link rel="stylesheet" type="text/css" href="../css/mui.min.css" />
		<link rel="stylesheet" href="../css/reset.css">
		<link rel="stylesheet" href="../css/one.css">
		<link rel="stylesheet" type="text/css" href="../css/find.css" />
		<script type="text/javascript" src="../js/jquery.min.js"></script>
		<script src="../js/mui.min.js"></script>
		<script src="../js/app.js"></script>
		<script src="../js/artTemplate-native.js"></script>
	</head>
	<style type="text/css">
		.subActive{
			color: red!important;
		}
		#imgUpload {
			display: none;
		}
		#header>*{
			color: white;
		} 
		#userBox{
				background-color: #F53C42;
				padding: 0px 0;
			    position: relative;
			    overflow: hidden;max-height: 2.5rem;
		}
		#mypic1{width: 100%;margin-top: -20%;}
		#beijing2{position: absolute;z-index:1;width: 100%;height: 100%;top: 0;background-color: rgba(255, 0, 0, 0.5);} 
		 
		.userAvator{
			border: 2px solid white;
			position: absolute;
			left: 50%;
			width: 1rem; 
			bottom: 0.5rem;
			height: 1rem; 
			-webkit-transform: translateX(-50%);
			z-index: 9;
			border-radius: 50%;
		}
		.mainInfo{ 
			position: relative;
			padding: 16px 10px 16px 15px;
			display: flex;
			align-items: center;
			justify-content: space-between;
		} 
		 .mainInfo:after{
		 	position: absolute;
		 	content: '';
		 	height: 1px;
		 	left: 10px;
		 	right: 10px;
			-webkit-transform: scaleY(.3);
			background: #C5C6C8;
			bottom: 0;
		 }
		.mainInfo button{
			font-size: 0.12rem;
			padding: 4px 8px;
		}
		.follow{
			background-color: white;
			margin: 15px 0;
			text-align: center;
			display: flex;
			align-items: center;
			height: 60px;
			line-height: 1.5;
			justify-content: space-around;
		}
		.follow>div{
			flex-grow:1;
		}
		.fchidl b{
			font-weight: 100;
			font-size: .16rem;
		}
		.fchidl>div{
			color: darkgray;
		}
		.chidlL{
			border-right: 1px solid #EEEEEE;
		}
		.fft{
			margin: 0;
		}
		
		
		.mui-bar-tab a{
			color: darkgray;
			display: table-cell;
			vertical-align: bottom;
			text-align: center;
		}
		.idhiji{
			position: absolute;
			text-align: center;
			bottom: 0.2rem;
			width: 100%;
			color: white;
			z-index: 1;
		}
		.tiename{color: #888;}	
		.ctime{margin-right: 15px;font-size: 12px;}
		.oaright{left: 0 !important;}
		.tiec, .ctime{margin-right: 0 !important;}
		.cmlist{padding: 18px 20px 20px 25px!important;background: white;}
		.noafter:after{height: 0 !important;}
		.cmlist:after{left: 25px !important;}
		.oaright p.tiec{padding: 5px !important;height: 0.6rem;overflow: hidden;background-color: rgba(242, 241, 238, 0.62);}  
		.oaright p.tiec span{display: -webkit-box;
			-webkit-box-orient: vertical;
			-webkit-line-clamp: 2;
			overflow: hidden;position: relative;top: -43px;padding-left: 0.75rem;color: #777;} 
		.tiec img{width: .7rem;}
		.noli{
			position: relative;overflow: hidden;
		}
		.noli:after{
		    position: absolute;
		    right: 0;
		    bottom: 0;
		    left: 15px;
		    height: 1px;
		    content: '';
		    -webkit-transform: scaleY(.2);
		    transform: scaleY(.2);
		    background-color: #c8c7cc;
		}
		.fft b, .follow b{color: #555;}
	</style>

	<body>

		<header id="header" class="mui-bar mui-bar-transparent">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">个人主页</h1>
		</header>
		<script src="../js/statusBar.js"></script>
		<!--状态栏-->
		<!--<div id="container">-->
		<div id="main">
			<div class="clearfloat box-s box-ss" id="userBox">
	    		<img id="mypic1" src="../img/morentouxiang.jpg"/>
	    		<div id="beijing2"></div> 
	    			<img src="../img/market/atcenter.jpg" class="userAvator"/> 
	    			<!--<div class="idhiji">HI集 ID:12345567</div>-->
	    	</div>
	    	<div class="content">
	    		<div class="mainInfo">
	    			<h4 style="color: #555;">扉页 <img src="../img/woman.svg" alt="" style="width: 0.15rem;"/></h4>
	    			<button type="button" class="mui-btn mui-btn-danger mui-btn-outlined editPage">
						编辑个人信息
					</button>
	    		</div> 
	    		<div class="follow fft">
					<div class="fchidl">
						<b>4</b>
						<div>赞的</div>
					</div>
					<div class="fchidl">
						<b>7</b>
						<div>被赞的</div>
					</div><div class="fchidl">
						<b>4</b>
						<div>分享的</div>
					</div>
					<div class="fchidl">
						<b>7</b>
						<div>评论</div>
					</div>
				</div>
	    	</div>

		</div>
		<div class="follow myfl">
			<div class="fchidl chidlL">
				<b>4</b>
				<div>关注</div>
			</div>
			<div class="fchidl">
				<b>7</b>
				<div>被关注</div>
			</div>
		</div>
		<p style="padding:0 10px 10px;"><small>我的动态</small></p>
		 <ul class="mui-table-view-striped mui-table-view-condensed">
							 
				<li class="noli cmlist" onclick="findInfo()"> 
					<div class="mui-slider-cell">
						<div class="oa-contact-cell mui-table">
						 	<!--<div class="oa-contact-avatar mui-table-cell cheader">
								<img src="../img/market/ag.jpeg" />
							</div>-->
							<div class="oa-contact-content mui-table-cell oaright oaf noafter">
								<div class="mui-clearfix">
									<div class="oa-contact-position mui-h5 fl tiename">发了贴</div>
								    <div class="oa-contact-position mui-h6 fr ctime">2015-11-19</div>
								</div> 
								<p class="oa-contact-email mui-h5 tiec"> 
									<img src="../img/market/bsl.jpeg" alt="" />	
									<span class="onespan">
										哈哈哈哈哈哈哈哈哈哈哈哈哈哈
									</span>
								</p>
							</div>
						</div>
					</div>
				</li>
				<li class="noli cmlist" onclick="findInfo()"> 
					<div class="mui-slider-cell">
						<div class="oa-contact-cell mui-table">
						 	<!--<div class="oa-contact-avatar mui-table-cell cheader">
								<img src="../img/market/ag.jpeg" />
							</div>-->
							<div class="oa-contact-content mui-table-cell oaright oaf noafter">
								<div class="mui-clearfix">
									<div class="oa-contact-position mui-h5 fl tiename">发了贴</div>
								    <div class="oa-contact-position mui-h6 fr ctime">2015-11-19</div>
								</div> 
								<p class="oa-contact-email mui-h5 tiec"> 
									<img src="../img/market/bsl.jpeg" alt="" />	
									<span class="onespan">
										哈哈哈哈哈哈哈哈哈哈哈哈哈哈
									</span>
								</p>
							</div>
						</div>
					</div>
				</li>
				<li class="noli cmlist" onclick="findInfo()"> 
					<div class="mui-slider-cell">
						<div class="oa-contact-cell mui-table">
						 	<!--<div class="oa-contact-avatar mui-table-cell cheader">
								<img src="../img/market/ag.jpeg" />
							</div>-->
							<div class="oa-contact-content mui-table-cell oaright oaf noafter">
								<div class="mui-clearfix">
									<div class="oa-contact-position mui-h5 fl tiename">发了贴</div>
								    <div class="oa-contact-position mui-h6 fr ctime">2015-11-19</div>
								</div> 
								<p class="oa-contact-email mui-h5 tiec"> 
									<img src="../img/market/bsl.jpeg" alt="" />	
									<span class="onespan">
										哈哈哈哈哈哈哈哈哈哈哈哈哈哈
									</span>
								</p>
							</div>
						</div>
					</div>
				</li>
				
			</ul>
			<div id="" style="padding-bottom: 70px;padding-top:10px;background-color: #fff;color: #999;text-align: center;"> 
				没有更多动态了
			</div>
			
			<!--底部导航-->
			 
			<nav class="mui-bar mui-bar-tab">
				<a onclick="gopage('Follow')">
					<span class="mui-icon mui-icon-eye"></span>
					<!--<span class="mui-tab-label">关注</span>-->
				</a>
				<a onclick="gopage('find')">
					<span class="mui-icon mui-icon-pengyouquan"></span>
					
					<!--<span class="mui-tab-label">广场</span>-->
				</a>
				<a onclick="gopage('publish')">
					<span class="mui-icon mui-icon-camera"></span>
					<!--<span class="mui-tab-label">消息</span>-->
				</a>
				<a onclick="gopage('message')">
					<span class="mui-icon mui-icon-chat">
	                	<!--<span class="mui-badge mui-badge-danger">6</span>-->
	                </span>
				</a>
				<a class="subActive">
					<span class="mui-icon mui-icon-person"></span>
					<!--<span class="mui-tab-label">个人主页</span>-->
				</a>
			</nav>
	</body>

	<script type="text/javascript">
		var falg = false; 
		//安卓返回键
	    mui.init({
	        beforeback: function(){
	             backindex();
	            return false; 
	        }
	    });
        function backindex(){
			falg = true;
		    //获得主页面的webview 
		    var appIndex = plus.webview.getLaunchWebview();
		    var mainweb = plus.webview.getWebviewById('main.html');
		    //触发主页面的gohome事件
		    mui.fire(appIndex,'gohome',{hrefid:'defaultTab'});
		    plus.webview.show(appIndex,"fade-in",500);
		    plus.webview.show(mainweb,"fade-in",500); 
		    if(plus.webview.getWebviewById('Follow')){
		    	plus.webview.getWebviewById('Follow').close();
		    }
		    if(plus.webview.getWebviewById('message')){
		    	plus.webview.getWebviewById('message').close();
		    }
		    if(plus.webview.getWebviewById('centerPage')){
		    	plus.webview.getWebviewById('centerPage').close();
		    }
		    if(plus.webview.getWebviewById('find')){
		    	plus.webview.getWebviewById('find').close();
		    }
			plus.webview.currentWebview().close();
		    
		}
		
		//滚动监听
		$(window).scroll(function() { 
           var navBarHeight = 50;  
            var targetID = "#header"; 
            //Window Math
            var scrollTo = $(window).scrollTop(); 
            if (scrollTo > navBarHeight) {
                $(targetID).css({
                    "background-image": "url(../img/header.png)","background-size":"100%"
                });
            } 
            if (scrollTo < navBarHeight) {
                $(targetID).css({
                    "background-image": "none"
                });
            } 
        }).trigger('scroll');
		
		
		//导航切换
		function gopage(page){ 
	  		event.preventDefault();
	  		function fotrue(){
		  		if(plus.webview.getWebviewById(page)){
		        	plus.webview.show(page,"fade-in",300);
		        	plus.webview.currentWebview().hide();
		        }else{
		        	openview({
						view:page+'.html',
						id:page
					});
		        }
	  		}
	  		if(page == 'find'){
	  			fotrue();
	  		}else{
	  			if(plus.storage.getItem('myToken')){
	  				fotrue();
	  			}else{
	  				mui.toast('请登录');
					openview({
						view:'login.html'
					});
	  			}
	  		}
	  	}
	
	   //编辑个人主页
		 mui('.editPage')[0].addEventListener('tap',function(){
			 
				openview({
					view:'personal/setup.html' 
				});
			 
		});
	    
	    
	    //帖子 详情
	    function findInfo(){
    		openview({
				view: "find/findInfo.html",
				id:"findInfo",
				extrasobj: {
					userId: 1
				}
			})
    	}
	    //赞的
	    $(".fft .fchidl:first-child").on("tap",function(){
	    	openview({
					view:'find/like.html' 
				});
	    })
	    //被赞的
	     $(".fft .fchidl:nth-child(2)").on("tap",function(){
	    	openview({
					view:'find/liked.html' 
				});
	    })
	    //分享的
	    $(".fft .fchidl:nth-child(3)").on("tap",function(){
	    	openview({
					view:'find/shareList.html' 
				});
	    })
	    
	    //评论的
	    $(".fft .fchidl:nth-child(4)").on("tap",function(){
	    	openview({
					view:'find/cmt.html' 
				});
	    })
	    
	    //关注
	    $(".myfl .fchidl:first-child").on("tap",function(){
	    	openview({
					view:'find/follow.html' 
				});
	    })
	    
	    // 粉丝 
		$(".myfl .fchidl:last-child").on("tap",function(){
	    	openview({
					view:'find/followed.html' 
				});
	    })
		//图片上传文件方法	
		function previewImage(file) {
			var MAXWIDTH = 350;
			var MAXHEIGHT = 249;
			var div = findPreview(file.parentNode);
			if(file.files && file.files[0]) {
				filepic = file.files[0];
				div.innerHTML = '<img id=imghead>';
				var img = div.lastChild;
				img.onload = function() {
					var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
					img.width = rect.width;
					img.height = rect.height;
				}
				var reader = new FileReader();
				reader.onload = function(evt) {
					img.src = evt.target.result;
				}
				reader.readAsDataURL(file.files[0]);
			}
		}

		function clacImgZoomParam(maxWidth, maxHeight, width, height) {
			var param = {
				top: 0,
				left: 0,
				width: width,
				height: height
			};
			if(width > maxWidth || height > maxHeight) {
				rateWidth = width / maxWidth;
				rateHeight = height / maxHeight;

				if(rateWidth > rateHeight) {
					param.width = maxWidth;
					param.height = Math.round(height / rateWidth);
				} else {
					param.width = Math.round(width / rateHeight);
					param.height = maxHeight;
				}
			}
			param.left = Math.round((maxWidth - param.width) / 2);
			param.top = Math.round((maxHeight - param.height) / 2);
			return param;
		}

		function findPreview(parent) {
			var childs = parent.childNodes;
			for(var i = 0; i < childs.length; i++) {
				if(childs[i].id == "preview")
					return childs[i];
			}
			return div = document.getElementById('preview');
		}
		
		
		
//		//发送 发布
//		mui('.baocun')[0].addEventListener('tap',function(){ 
////			plus.nativeUI.showWaiting('发送中 ...',{width:'100px',height:'80px'});
//			var text = $('.disbg').text() || null;
//			alert(text) 
//			var touxiang = mui('#imgUpload')[0].files[0] || {};
//			alert(touxiang.length)
//			mui.plusReady(function(){ 
//				var myuserid = plus.storage.getItem('userid');
//				var oldtoken = plus.storage.getItem('oldToken');
//				 
//				function upfun1(){
//					var fd = new FormData(); 
//					if(touxiang.name){
//						fd.append('avatar',touxiang);
//					}else{
//						alert(5)
//					}
////			        fd.append('userid',myuserid);  		
////			        fd.append('nickname',mynickname);  		
////			        fd.append('gender',Nextbtnval[Nextbtnval.length-1]);  		
////			        fd.append('IDCard',IDnum);  		
////			        var xhr = new XMLHttpRequest();  	
////			        xhr.open('POST',serverUrl+'/api/useraccount/updateuserdata',true); 	
////			    	xhr.onreadystatechange = function(){
////			    		if (xhr.readyState===4) { 
////	    					if (xhr.status===200) {
////	    						plus.nativeUI.closeWaiting();//关闭等待框
////	    						var dataobj = JSON.parse(xhr.responseText);
////	    						console.log('修改'+xhr.responseText);
////	    						if(dataobj.errno == 0){
////	    							mui.toast('修改成功');	 
////	    							//触发跳转页面刷新
////									mui.fire(plus.webview.getWebviewById('center.html'),'refresh');
////									if(plus.webview.getWebviewById('market-order')){ 
////										mui.fire(plus.webview.getWebviewById('market-order'),'refresh2');
////									}
////									var time2 = setTimeout(function(){
////										plus.webview.currentWebview().close();
////									},500)
////	    						}else{
////	    							mui.toast('保存失败');	
////	    						}
////	    					}else{
////	    						mui.toast('响应失败');	
////	    					}
////	    				}
////			        } 
////			        xhr.setRequestHeader("token",oldtoken);
////			        xhr.send(fd);
//				}
//			})
//		})
	</script>

</html>