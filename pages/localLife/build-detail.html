<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>房产详情</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/common.css">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css">
		<link rel="stylesheet" href="../../css/reset.css">
		
		<style type="text/css">
			/*banner底部导航*/
			.mui-slider-indicator .mui-indicator{width: 10px;
				height: 10px;
				border-radius: 8px;
				background: black;
				margin-right: 5px;
				opacity: 0.3;
				cursor: pointer;
				border: none;
				box-shadow: none;
			}
			.mui-slider-indicator .mui-active.mui-indicator{background-color: rgba(245,60,66,0.8);
				box-shadow: none;
				opacity: 1;
				border: none;
			}
			.mui-bar{height: 50px;
			}
			.mui-title,.mui-icon{line-height: 50px;
			}
			.mui-bar .mui-icon{padding: 0;
			}
			.mui-bar-nav.mui-bar .mui-icon,.mui-title,.mui-icon{color: #fff;
			}
			.mui-bar-nav{box-shadow: none;
			}
			.mui-icon{line-height: 50px;
			}	
			.mui-icon .iconfont{font-size: 18px;
			}
			.dealcard, .cinemacard{margin-top: 50px;
			}
			.dealcard .dealcard-img img{height: 60px;
				overflow: hidden;
			}
		 	.shoucang .iconfont{font-size: 18px;
			}
			
			#main{margin-top: 50px;
			}
			.dealcard, .cinemacard{margin-top: 45px;
			}
			.dealcard, .cinemacard{margin-top: 45px;
			}
			
			.farm .bottom ul li{text-overflow: ellipsis;white-space: nowrap;
				overflow: hidden;
				display: block;
				width: 100%;
			}
			/*banner图片固定高度比例*/
			.mui-slider-item a{
				position: relative;
				display: inline-block;
				padding-top: 55.56%;
				width: 100%;
				overflow: hidden;
			}
			.goodsImg{
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
			}
			.list,.bottom{
				border-bottom: 1px solid #EFEFF4 !important;
				border-top: 1px solid #EFEFF4 !important;
			}
			.top,.farm{
				border-bottom: none !important;
			}
			.farmtc .bt{
				border-top: 1px solid #EFEFF4 !important;
			} 
			.merchant .biz-call .phone{margin-top: -7px;}
			.rentingtopbot {padding-bottom: 40px !important;}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" id="header"> 
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize"></a>
		    <h1 class="mui-title">详情</h1>
			<a href="setup.html" class="fr shoucang sousuo mui-icon"><i class="iconfont icon-fenxiang"></i></a>
		</header>
		<!--状态栏-->
		<div id="sBar" style="background-color: #f53c42;position: fixed;width:100%;top: 0;z-index: 9999"></div>
		<script type="text/javascript">
			var immersed = 0;
			var ms=(/Html5Plus\/.+\s\(.*(Immersed\/(\d+\.?\d*).*)\)/gi).exec(navigator.userAgent);
			if(ms&&ms.length>=3){ // 当前环境为沉浸式状态栏模式
			    immersed=parseFloat(ms[2]);// 获取状态栏的高度
			}
			var statusBar = document.getElementById('sBar');//这是模拟状态栏
			var headdiv = document.getElementById('header');//这是现有的header
			document.body.style.paddingTop =  immersed+'px';
			statusBar&&(statusBar.style.height = immersed+'px');
			headdiv&&(headdiv.style.top = immersed+'px');
		</script>
		<!--状态栏结束-->
		
		<!--详情内容-->
		<div id="container">		
			<div id="main"></div>
			<script type="text/html" id="details">
				<div class="deal">
					<!--轮播图-->
					<div class="mui-slider">
						  <div class="mui-slider-group mui-slider-loop">
						    <!--支持循环，需要重复图片节点-->
						    <div class="mui-slider-item mui-slider-item-duplicate"><a><img src="<%= pic[pic.length-1].picImg%>" class="goodsImg"></a></div>
						    <% for(var i=0; i<pic.length; i++) {%>
						    	<div class="mui-slider-item"><a><img src="<%= pic[i].picImg%>" class="goodsImg"></a></div> 
						    <% }%>	
						    <!--支持循环，需要重复图片节点-->
						    <div class="mui-slider-item mui-slider-item-duplicate"><a><img src="<%= pic[0].picImg%>" class="goodsImg"></a></div>
						  </div>
			            <div class="mui-slider-indicator">
							<div class="mui-indicator mui-active"></div>
							<% for(var i=0;i<pic.length-1;i++){ %>
						    	<div class="mui-indicator"></div>
						    <% } %>
			            </div>
					</div>
					<!--轮播图结束-->
					<div class="farm clearfloat">
						<div class="top rentingtop clearfloat box-s">
							<p><%= list.name%></p>
							<p class="time">
								发布时间：<%= list.create_time%>
								<!--浏览：413人-->
							</p>
						</div>
						<div class="bottom clearfloat box-s">
							<ul>
								<li>
									<p class="fl">小区名称：</p>
									<%= list.quarters%>
								</li>
								<li>
									<p class="fl">小区地址：</p>
									<%= list.area_address%>
								</li>
								<li>
									<p class="fl">平均售价：</p>
									<%= list.avg_price%>
								</li>
								<li>
									<p class="fl">中介名称：</p>
									<%= list.intermediary_name%>
								</li>
								<li> 
									<p class="fl">房间户型：</p>
									<%= list.house_layout%>
								</li>
								<li>
									<p class="fl">房间面积：</p>
									<%= list.house_area%>
								</li>
								<li>
									<p class="fl">房间价格：</p>
									<%= list.price%>
								</li>
								<%if(list.house_type){%>
									<li>
										<p class="fl">房间类型：</p>
										<%= list.house_type%>
									</li>
								<%}%>
							</ul>
						</div>
					</div>
					<dl class="list">
						<dd class="dd-padding">
							<div class="merchant">
								<div class="biz-detail">
									<a class="react" href="#" title="">
										<h5 class="title single-line">电话: <%= list.phone%></h5>

										<div class="address single-line">地址: <%= list.address%></div>
									</a>
								</div>
								<div class="biz-call">
									<a class="react phone" href="tel:<%= list.phone%>"> 
										<i class="text-icon">✆</i>
									</a>
								</div>
							</div>
						</dd>
					</dl>							
				</div>
				<div class="farmtc clearfloat mt10">
					<p class="bt box-s">房屋简介</p>
				</div>
				<div class="farm clearfloat">
					<div class="top rentingtop rentingtopbot clearfloat box-s">
						<p><%= list.content%></p>
					</div>					
				</div>
			</script>
		</div>
		
		
		
	</body>
	<script src="../../js/mui.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="../../js/app.js" type="text/javascript" charset="utf-8"></script>
	<script src="../../js/artTemplate-native.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		mui.plusReady(function(){
			plus.nativeUI.showWaiting('加载中 ...',{width:'100px',height:'80px'});
			//获取数据
			var oldtoken = plus.storage.getItem('oldToken');
			var nowid = plus.webview.currentWebview().name;
			mui.ajax(serverUrl+'/api/localservice/houseinfo',{
				data:{house_id:nowid},
				type:'post',
				timeout:10000,
				headers:{"token":oldtoken},	               				
				success:function(data){
					//alert(mytoken);
					console.log('获取数据返回'+JSON.stringify(data));
					if(data.errno == 0){
						var objdata = {};
						console.log(data.data); 
						data.data.create_time = data.data.create_time.split('T')[0]
						objdata.list = data.data; 
						
						objdata.pic = JSON.parse(objdata.list.pic);//轮播图
						console.log(objdata.pic);
						var html=template("details",objdata);
						document.getElementById("main").innerHTML=html;
						plus.nativeUI.closeWaiting();
						//轮播图
						var gallery = mui('.mui-slider');
						gallery.slider({
						  interval:5000//自动轮播周期，若为0则不自动播放，默认为0；
						});
					}else{
						mui.toast('获取用户信息失败');
						plus.nativeUI.closeWaiting();
						console.log(data.errmsg);
					}
				},
				error:function(xhr,type,errorThrown){
					plus.nativeUI.closeWaiting();
					alert('响应失败  !');
				}
			});
		})
		
		
	</script>
</html>