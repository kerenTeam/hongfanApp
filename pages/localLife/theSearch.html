<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>搜索</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="address=no">
		<link rel="stylesheet" type="text/css" href="../../css/common.css">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css">
		<link rel="stylesheet" href="../../css/reset.css">
		<link href="../../css/mui.picker.min.css" rel="stylesheet" />
		<link href="../../css/mui.poppicker.css" rel="stylesheet" />
		<script src="../../js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<script type="text/javascript" src="../../js/jquery.flexslider-min.js"></script>
		<!--<script type="text/javascript" src="../../js/iscroll.js"></script>-->
		<script type="text/javascript" src="../../js/swiper.min.js"></script>
		<!--<script type="text/javascript" src="../../js/index.js"></script>-->
		<script src="../../js/mui.picker.min.js"></script>
		<script src="../../js/mui.poppicker.js"></script>
		
		<script src="../../js/other.js" type="text/javascript" charset="utf-8"></script>
		
		<style type="text/css">
		 .mui-search:before{
		 	top:58%;
		 }
			.mui-bar{
				height: 50px;
			}
			.mui-title,.mui-action-back{
				line-height: 50px !important;
			}
			.mui-bar .mui-icon{
				padding: 0;
			}
			.mui-bar-nav.mui-bar .mui-icon,.mui-title,.mui-icon{
				color: #fff;
			}
			.mui-bar-nav{
				box-shadow: none;
			}
			/*.mui-icon{
				line-height: 50px;
			}	*/
			.mui-icon .iconfont{
				font-size: 18px;
			}
		
			.theSearch{
				width: 100%;
				background-color: #fff;
				margin-top: 50px;
				padding-top: 1px;
			}
			.mui-input-row .mui-btn+input, .mui-input-row label+input, .mui-input-row:last-child{
				margin: 10px;
			}
			input[type=search]{
				margin-bottom: 10px;
			}
			.mui-icon-search,.mui-icon-arrowright{
				color: #ddd;
				vertical-align: middle;
			}
			 .searchOut{
			 	display: none;
			 	position: fixed;
			 	top: 89px;
			 	width: 100%;
			 }
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize"></a>
		    <h1 class="mui-title">搜索</h1>
		</header>
		<script src="../../js/statusBar.js"></script><!--状态栏-->
		<div class="theSearch">
			<div class="mui-input-row mui-search">
			    <input type="search" id="words" class="mui-input-clear" placeholder="">
			</div>
		</div>
		<div id="container">
			<section class="hotBox">
				<div class="title">热门搜索</div>
				<ul class="hotKeyUl">
					<li>
						<a href="#">酒店</a>
					</li>
					<li>
						<a href="#">火锅</a>
					</li>
					<li>
						<a href="#">料理</a>
					</li>
					<li>
						<a href="#">酒店</a>
					</li>
					<li>
						<a href="#">电影</a>
					</li>
					<li>
						<a href="#">家政</a>
					</li>
					<li>
						<a href="#">洗车</a>
					</li>
					<li>
						<a href="#">美妆</a>
					</li>
				</ul>
			</section>
			
			<!--搜索历史-->
			
			<div id="record"></div>
				<script id="recordTpt" type="text/html">
					<%if(data.length==0){%>
						<!--<div class="searchRecord">
							&nbsp;&nbsp;搜索记录:无
						</div> -->
						<%}else{%>
							<section class="historyBox" style="">
								<div class="title">搜索历史</div>
								<ul>
									<%for(var i=data.length-1;i>=0;i--){%>
										<li class="link-url"><span class="mui-icon mui-icon-search"></span> <%=data[i]%><span class="mui-icon mui-icon-arrowright fr"></span></li>
									<%}%>
									 <li class="clear clearStr">清除搜索记录</li>
								</ul>
							</section> 
							<%}%>
					
				</script> 
		 </div>
		 <!--搜索结果-->
		    <section class="historyBox searchOut" style=""> 
				<ul>
					<li class="link-url"><span class="mui-icon mui-icon-search"></span> 食物<span class="mui-icon mui-icon-arrowright fr"></span></li>
					<li class="link-url"><span class="mui-icon mui-icon-search"></span> 食物<span class="mui-icon mui-icon-arrowright fr"></span></li>
					<li class="link-url"><span class="mui-icon mui-icon-search"></span> 食物<span class="mui-icon mui-icon-arrowright fr"></span></li>
				</ul>
			</section>
	</body>
	<script src="../../js/artTemplate-native.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		(function(){
			
			mui.plusReady(function(){
				//缓存记录
			var searchStorage =JSON.parse(plus.storage.getItem("$searchStorage") || '[]');
			
			$("input").on('change',function(){
				alert(2)
				if($("input").val()!=''){ 
					var words=$("input").val();
					if(searchStorage.length != 0) {
						var flag = false;
						for(var i = 0; i < searchStorage.length; i++) {
							if(searchStorage[i] == words) {
								
								searchStorage[i] = words;
								flag = false;
								break;
							} else {
								flag = true;
							}
						}
						if(flag) {
							searchStorage.push(words);
						}
					} else { 
						searchStorage.push(words);
						
					} 
					plus.storage.setItem('$searchStorage', JSON.stringify(searchStorage)); 
					alert("执行搜索")
					alert(JSON.stringify(searchStorage))
					$("#container").css("display","none");
					$(".searchOut").css("display","block");
				}else{
					$("#container").css("display","block");
					$(".searchOut").css("display","none");
				} 
			})
			$(".mui-icon-clear:before,.mui-icon-close-filled:before").on('click',function(){ 
				alert(1)
					$("#container").css("display","block");
				$(".searchOut").css("display","none"); 
			})
 
 			
			 //alert(searchStorage.length)
			var recordObj = {};
				recordObj.data= searchStorage;
			var htmlrecord = template('recordTpt', recordObj);
			    document.getElementById('record').innerHTML = htmlrecord;
			     mui('.clearStr')[0].addEventListener('tap',function(){
				 	//alert(22)
				 	plus.storage.removeItem("$searchStorage");
				 	mui("#record")[0].style.display="none"
				 })
				//搜索某一条 缓存 
				  $('.searchli').click(function(e){
				   	e.preventDefault();
				   	alert("执行搜索")
				  })
				})
			
			  
			//输入搜索
//			document.getElementById('words').addEventListener('change', function() {
//				$('.searchRecord').css('display','none');
//				var words = this.parentNode.getElementsByTagName('input')[0].value;
//				if(words == '') {
//					mui.toast("请输入食材或菜名");
//				} else {
//					
//				}
//			});
		})();
	</script>
</html>