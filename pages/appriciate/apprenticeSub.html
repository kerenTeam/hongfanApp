<html>
	<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
			<title>活动报名</title>
			<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
			<meta name="apple-mobile-web-app-capable" content="yes">
			<meta name="apple-touch-fullscreen" content="yes">
			<meta name="apple-mobile-web-app-status-bar-style" content="black">
			<meta name="format-detection" content="telephone=no">
			<meta name="format-detection" content="address=no">
			<link rel="stylesheet" type="text/css" href="../../css/common.css">
			<link rel="stylesheet" type="text/css" href="../../css/index.css">
			<link rel="stylesheet" type="text/css" href="../../css/mui.min.css">
			<link rel="stylesheet" href="../../css/reset.css">
			<link href="../../css/mui.picker.min.css" rel="stylesheet" />
			<link href="../../css/mui.poppicker.css" rel="stylesheet" />
			<script src="../../js/mui.min.js" type="text/javascript" charset="utf-8"></script>
			<script type="text/javascript" src="../../js/jquery.min.js"></script>
			<script src="../../js/mui.picker.min.js"></script>
			<script src="../../js/mui.poppicker.js"></script>
			<script src="../../js/binaryajax.js" ></script>
			<script src="../../js/canvasResize.js" ></script>
			<script src="../../js/exif.js" ></script>
			<style>
			.mui-icon-camera:before {
				content: '\e301'
			}
			@font-face {
				font-family:Muiicons;font-weight:400;font-style:normal;src:url(fonts/mui.ttf) format('truetype')
			}
			.mui-icon {
				font-family: Muiicons;
				font-size: 24px;
				font-weight: 400;
				font-style: normal;
				line-height: 1;
				display: inline-block;
				text-decoration: none;
				-webkit-font-smoothing: antialiased
			}
			.mui-icon.mui-right:before {
				float: right;
				padding-left: .2em
			}
			*{
			    -webkit-box-sizing: border-box;
			            box-sizing: border-box;
			    outline: none;
			    -webkit-tap-highlight-color: transparent;
			    -webkit-tap-highlight-color: transparent;
			}
			.mui-btn{
			    font-size: 14px;
			    font-weight: 400;
			    line-height: 1.42;
			    position: relative;
			    display: inline-block;
			    margin-bottom: 0;
			    padding: 6px 12px;
			    cursor: pointer;
			    -webkit-transition: all;
			            transition: all;
			    -webkit-transition-timing-function: linear;
			            transition-timing-function: linear;
			    -webkit-transition-duration: .2s;
			            transition-duration: .2s;
			    text-align: center;
			    vertical-align: top;
			    white-space: nowrap;
			    background-clip: padding-box;
			}
			.mui-btn-outlined.mui-btn-primary, .mui-btn-outlined.mui-btn-blue{
			    color: #f53c42;
			    border: 1px solid #f53c42;
			}
			.mui-btn-block{
			    font-size: 18px;
			    display: block;
			    width: 100%;
			    margin-bottom: 10px;
			    padding: 15px 0;
			}
			.mui-table-view{
			    position: relative;
			    margin-top: 0;
			    margin-bottom: 0;
			    padding-left: 0;
			    list-style: none;
			}
			.mui-table-view-cell{
			    position: relative;
			    overflow: hidden;
			    padding: 11px 15px;
			    -webkit-touch-callout: none;
			}
			.mui-table-view-cell > a:not(.mui-btn){
			    position: relative;
			    display: block;
			    overflow: hidden;
			    margin: -11px -15px;
			    padding: inherit;
			    white-space: nowrap;
			    text-overflow: ellipsis;
			    color: inherit;
			}
			.mui-popover{
			    position: absolute;
			    z-index: 999;
			    display: none;
			    width: 280px;
			    -webkit-transition: opacity .3s;
			            transition: opacity .3s;
			    -webkit-transition-property: opacity;
			            transition-property: opacity;
			    -webkit-transform: none;
			            transform: none;
			    opacity: 0;
			    border-radius: 7px;
			    background-color: #f7f7f7;
			    -webkit-box-shadow: 0 0 15px rgba(0, 0, 0, .1);
			            box-shadow: 0 0 15px rgba(0, 0, 0, .1);
			}
			.mui-popover .mui-popover-arrow{
			    position: absolute;
			    z-index: 1000;
			    top: -25px;
			    left: 0;
			    overflow: hidden;
			    width: 26px;
			    height: 26px;
			}
			.mui-popover .mui-popover-arrow:after{
			    position: absolute;
			    top: 19px;
			    left: 0;
			
			    width: 26px;
			    height: 26px;
			
			    content: ' ';
			    -webkit-transform: rotate(45deg);
			            transform: rotate(45deg);
			
			    border-radius: 3px;
			    background: #f7f7f7;
			}
			.mui-popover .mui-popover-arrow.mui-bottom{
			    top: 100%;
			    left: -26px;
			
			    margin-top: -1px;
			}
			.mui-popover .mui-popover-arrow.mui-bottom:after{
			    top: -19px;
			    left: 0;
			}
			.mui-popover.mui-popover-action{
			    bottom: 0;
			    width: 100%;
			    -webkit-transition: -webkit-transform .3s, opacity .3s;
			            transition:         transform .3s, opacity .3s;
			    -webkit-transform: translate3d(0, 100%, 0);
			            transform: translate3d(0, 100%, 0);
			    border-radius: 0;
			    background: none;
			    -webkit-box-shadow: none;
			            box-shadow: none;
			}
			.mui-popover.mui-popover-action .mui-popover-arrow{
			    display: none;
			}
			.mui-popover.mui-popover-action.mui-popover-bottom{
			    position: fixed;
			}
			.mui-popover.mui-popover-action.mui-active{
			    -webkit-transform: translate3d(0, 0, 0);
			            transform: translate3d(0, 0, 0);
			}
			.mui-popover.mui-popover-action .mui-table-view .mui-table-view-cell:after{
			    position: absolute;
			    right: 0;
			    bottom: 0;
			    left: 0;
			    height: 1px;
			    content: '';
			    -webkit-transform: scaleY(.5);
			            transform: scaleY(.5);
			}
			.mui-popover.mui-popover-action .mui-table-view small{
			    font-weight: 400;
			    line-height: 1.3;
			    display: block;
			}
			.mui-popover.mui-active{
			    display: block;
			    opacity: 1;
			}
			.mui-popover .mui-bar ~ .mui-table-view{
			    padding-top: 44px;
			}
			.mui-backdrop{
			    position: fixed;
			    z-index: 998;
			}
			header{
				height: 50px !important;
			}
			header h1,.mui-bar-nav.mui-bar .mui-icon, .mui-title, #theSearch{
				line-height: 50px !important;
				padding: 0;
			}
			.sure {
				margin-top: 10px;
			}
			.sure button{
				width: 95%;
				background-color: #f53c42;
				color: #fff;
				border: none;
				height: 42px;
				font-size: 16px;
			}
			.mui-btn-blue, .mui-btn-primary, input[type=submit]{
				background-color: #fff !important;
				width: 95%;
			}
			.mobile{
				margin: 50px 0 30px 0;
			}
			
			.mui-bar-nav.mui-bar .mui-icon,.mui-title,#theSearch{
				color: #fff;
			}
			.mui-bar-nav{
				box-shadow: none;
			}
			.dealcard, .cinemacard{
				margin-top: 45px;
			}
			.dealcard .dealcard-img img{
				height: 60px;
				overflow: hidden;
			}
			#main{
				padding-bottom: 60px;
			}
			.recharge .czhi input{width: 100%;}
			.Ynull{
				text-align: right;
				width:-moz-calc(100% - 0.5rem)!important;
				width:-webkit-calc(100% - 0.5rem)!important;
				width: calc(100% - 0.5rem)!important;
			}
			.czhi span{
				width: 0.45rem!important;
				text-align: center;
				
			}
			</style>
	</head>

	<body>
		<!--header star-->
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left bigSize"></a>
		    <h1 class="mui-title" id="header">活动报名</h1>
		</header>
		<script src="../../js/statusBar.js"></script><!--状态栏-->
		<div class="mobile">
			 
		</div> 
	    	<div class="recharge clearfloat">
	    		<div class="czhi clearfloat box-s">
	    			<span>姓名</span> <input type="text" id="Bname" class="Ynull fr" value=""/>
	    		</div>
	    		<div class="czhi clearfloat box-s">
	    			<span>电话</span> <input type="text" id="Bphone" class="Ynull fr" value=""/>
	    		</div> 
	    		<div class="czhi clearfloat box-s">
	    			<span>性别</span> <input type="text" id="Bclass" class="Ynull" value=""/>
	    		</div>
	    		<div class="czhi clearfloat box-s">
	    			<span>年龄</span> <input type="number" id="Bage" class="Ynull fr" min="20" max="50" value=""/>
	    		</div>
	    		<div class="czhi clearfloat box-s">
	    			<span>报名费</span> <input type="text" id="Bprice" class="Ynull fr" readonly disabled/>
	    		</div> 
	    	</div>	    	
	    </div>
	    <div class="renting-footer renting-footertwo clearfloat" id="footer">
			<ul>
				<li id="Releasebtn">立即报名</li>
			</ul>
		</div>
		<div id="picture" class="mui-popover mui-popover-action mui-popover-bottom">
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a id="0" href="#" style="color:#8f8f94;font-size: .8em;">选择照片</a>
				</li>
				<li class="mui-table-view-cell">
					<a id="1" href="#">拍照</a>
				</li>
				<li class="mui-table-view-cell">
					<a id="2" href="#">从相册选择</a>
				</li>
			</ul>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a href="#picture"><b>取消</b></a>
				</li>
			</ul>
		</div>
		<div id="opt" class="mui-popover mui-popover-action mui-popover-bottom">
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a id="3" href="#" style="color:#8f8f94;font-size: .8em;">操作</a>
				</li>
				<li class="mui-table-view-cell">
					<a id="4" href="#">查看</a>
				</li>
				<li class="mui-table-view-cell">
					<a id="5" href="#">删除</a>
				</li>
			</ul>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a href="#opt"><b>取消</b></a>
				</li>
			</ul>
		</div>
		
	</body>
</html>
<script src="../../js/app.js"></script> 
<script type="text/javascript" >
 
	//上传部分
	var reg_phone = /^1((3|4|5|8|7){1}\d{1}|70)\d{8}$/;//手机号正则
	mui.plusReady(function(){
		var oldtoken = plus.storage.getItem('oldToken');
		var myuserid = plus.storage.getItem('userid');
		var apprenticeId = plus.webview.currentWebview().apprenticeId;
		var apprenticeFee = plus.webview.currentWebview().apprenticeFee;
		console.log(oldtoken);
		if(apprenticeFee > 0){
			document.getElementById('Bprice').value = apprenticeFee;
		}else{
			document.getElementById('Bprice').value = "免费";
		}
		
//		alert(apprenticeFee);
		
		mui('#Releasebtn')[0].onclick = function(){ 
			
			//获取所需data
			var name = mui('#Bname')[0].value;
			var mobileno = mui('#Bphone')[0].value;
			var gender = mui('#Bclass')[0].value;
			var age = mui('#Bage')[0].value;
			var price = document.getElementById('Bprice').value;
			
			var Ynulls = mui('.Ynull');
//			if(mui('#Bname')[0].value==''){
//				mui.toast('请输入您的姓名');
//				mui('#Bname')[0].focus();
//			}
//			else if(!reg_phone.test(mui('#Bphone')[0].value)){
//				mui.toast('请输入正确的手机号');
//				mui('#Bphone')[0].focus();
//			}
//			else if(mui('#Bclass')[0].value!='男' && mui('#Bclass')[0].value!='女'){
//				mui.toast('请输入您的性别');
//				mui('#Bclass')[0].focus();
//			}
//			else if(mui('#Bage')[0].value==''){
//				mui.toast('请输入您的年龄');
//				mui('#Bage')[0].focus();
//			}
//			else{
//				for (var i=0; i<Ynulls.length; i++) {
//					if(!Ynulls[i].value){
//						Ynulls[i].focus();
//						mui.toast('请输入'+Ynulls[i].placeholder);
//						break; 
//					}
//					if(i==Ynulls.length-1){
						if(!price == "免费"){
							
							//铺数据
							var oldToken = plus.storage.getItem('oldToken');
							console.log(oldToken);
							mui.ajax(serverUrl+'/api/localservice/activityjoin',{
								data:{id:apprenticeId,userid:myuserid,name:name,gender:gender,mobileno:mobileno,age:age},
								dataType:'json',
								type:'post',
								timeout:10000,
								headers:{"token":oldToken},	 
								success:function(data,type,xhr){
									alert(JSON.stringify(data.data));
									plus.nativeUI.showWaiting('提交中 ...',{width:'100px',height:'80px'});//显示等待框
									var dateObj={};
									for(var i = 0;i < data.data.length;i++){
										data.data[i].time = data.data[i].time.split('T')[i]; 
							       		data.data[i].begin_time = data.data[i].begin_time.split('T')[i]; 
							       		data.data[i].end_time = data.data[i].end_time.split('T')[i]; 
									}
									dateObj.objData=data.data;
									mui('#Alist')[0].innerHTML = template('Alist-detail',dateObj);
								},
								error:function(xhr,type,errorThrown){
									alert('响应失败  !');
								}
							});						
						}else{
							
						}
						
//					}
//				}
//			
//			}
		}
	})
</script>